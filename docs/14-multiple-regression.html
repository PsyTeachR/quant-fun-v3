<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Materials for the MSc Conversion Research Methods 1 and 2 courses at the University of Glasgow School of Psychology &amp; Neuroscience.">
<title>Fundamentals of Quantitative Analysis - 14&nbsp; Multiple Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./16-analysis-journeys.html" rel="next">
<link href="./13-factorial-anova.html" rel="prev">
<link href="./images/logos/logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">
<link rel="stylesheet" href="include/booktem.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/glossary.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./14-multiple-regression.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multiple Regression</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Fundamentals of Quantitative Analysis</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/BartlettJE/quant-fun-v3/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-foreword.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to use this book</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-programming-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to programming with R/R Studio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-starting-with-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Creating Reproducible Documents</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-intro-data-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Data Visualisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-wrangling-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data wrangling 1: Join, select, and mutate</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-wrangling-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data wrangling 2: Filter and summarise</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-wrangling-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Wrangling 3: Pivots and Pipes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-more-visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Scatterplots, boxplots, and violin-boxplots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-lm-continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regression with one continuous predictor</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-lm-categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Regression with one categorical predictor</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Statistical Power and Effect Sizes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-screening-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Screening Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">One-way ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-factorial-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-multiple-regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multiple Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-analysis-journeys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Journeys</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-analysis-journey-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Analysis Journey 1: Data Wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-analysis-journey-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Analysis Journey 2: Simple Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a2-additional-learning-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a3-How-to-cite-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Citing R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-b-symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Symbols</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-d-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-y-license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#chapter-preparation" id="toc-chapter-preparation" class="nav-link active" data-scroll-target="#chapter-preparation"><span class="header-section-number">14.1</span> Chapter preparation</a>
  <ul class="collapse">
<li><a href="#introduction-to-the-data-set" id="toc-introduction-to-the-data-set" class="nav-link" data-scroll-target="#introduction-to-the-data-set"><span class="header-section-number">14.1.1</span> Introduction to the data set</a></li>
  <li><a href="#organising-your-files-and-project-for-the-chapter" id="toc-organising-your-files-and-project-for-the-chapter" class="nav-link" data-scroll-target="#organising-your-files-and-project-for-the-chapter"><span class="header-section-number">14.1.2</span> Organising your files and project for the chapter</a></li>
  <li><a href="#mulregression-a1" id="toc-mulregression-a1" class="nav-link" data-scroll-target="#mulregression-a1"><span class="header-section-number">14.1.3</span> Activity 1 - Load the packages and read the data</a></li>
  <li><a href="#mulregression-a2" id="toc-mulregression-a2" class="nav-link" data-scroll-target="#mulregression-a2"><span class="header-section-number">14.1.4</span> Activity 2 - Explore the data</a></li>
  <li><a href="#mulregression-a3" id="toc-mulregression-a3" class="nav-link" data-scroll-target="#mulregression-a3"><span class="header-section-number">14.1.5</span> Activity 3 - Compute the well-being score for each respondent</a></li>
  <li><a href="#activity-4---wrangle-and-visualise-the-data" id="toc-activity-4---wrangle-and-visualise-the-data" class="nav-link" data-scroll-target="#activity-4---wrangle-and-visualise-the-data"><span class="header-section-number">14.1.6</span> Activity 4 - Wrangle and visualise the data</a></li>
  </ul>
</li>
  <li>
<a href="#mulregression-a5" id="toc-mulregression-a5" class="nav-link" data-scroll-target="#mulregression-a5"><span class="header-section-number">14.2</span> Multiple linear regression</a>
  <ul class="collapse">
<li><a href="#activity-5---complete-the-final-wrangling-steps" id="toc-activity-5---complete-the-final-wrangling-steps" class="nav-link" data-scroll-target="#activity-5---complete-the-final-wrangling-steps"><span class="header-section-number">14.2.1</span> Activity 5 - Complete the final wrangling steps</a></li>
  <li><a href="#mulregression-a6" id="toc-mulregression-a6" class="nav-link" data-scroll-target="#mulregression-a6"><span class="header-section-number">14.2.2</span> Activity 6 - Mean-centering variables</a></li>
  <li><a href="#mulregression-a8" id="toc-mulregression-a8" class="nav-link" data-scroll-target="#mulregression-a8"><span class="header-section-number">14.2.3</span> Activity 7 - Running the regression</a></li>
  <li><a href="#activity-8---visualising-interactions" id="toc-activity-8---visualising-interactions" class="nav-link" data-scroll-target="#activity-8---visualising-interactions"><span class="header-section-number">14.2.4</span> Activity 8 - Visualising interactions</a></li>
  <li><a href="#mulregression-a9" id="toc-mulregression-a9" class="nav-link" data-scroll-target="#mulregression-a9"><span class="header-section-number">14.2.5</span> Activity 9 - Assumption checking</a></li>
  <li><a href="#mulregression-a10" id="toc-mulregression-a10" class="nav-link" data-scroll-target="#mulregression-a10"><span class="header-section-number">14.2.6</span> Activity 10 - Power and effect sizes</a></li>
  </ul>
</li>
  <li><a href="#mulregression-a11" id="toc-mulregression-a11" class="nav-link" data-scroll-target="#mulregression-a11"><span class="header-section-number">14.3</span> Reporting the results of multiple linear regression</a></li>
  <li><a href="#mulregression-fin" id="toc-mulregression-fin" class="nav-link" data-scroll-target="#mulregression-fin"><span class="header-section-number">14.4</span> End of Chapter</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/BartlettJE/quant-fun-v3/edit/main/14-multiple-regression.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/BartlettJE/quant-fun-v3/issues/new" class="toc-action">Report an issue</a></p><p><a href="https://github.com/BartlettJE/quant-fun-v3/blob/main/14-multiple-regression.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multiple Regression</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In Chapters 8 and 9 from the Research Methods 1 content, we covered simple linear regression to investigate the effect of one predictor on one outcome. At the start of Research Methods 2, we then started to explore ANOVA models to handle more complex designs.</p>
<p>In this chapter, we end the core content on learning how to apply and interpret multiple regression models. This uses the full flexibility of the general linear model to express more complicated designs where you have multiple predictors or interactions between predictors.</p>
<p><strong>Chapter Intended Learning Outcomes (ILOs)</strong></p>
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li><p>Apply and interpret multiple linear regression models.</p></li>
<li><p>Interpret coefficients from individual predictors and interactions.</p></li>
<li><p>Visualise interactions as model predictions to understand and communicate your findings.</p></li>
<li><p>Calculate statistical power for a multiple regression model.</p></li>
</ul>
<section id="chapter-preparation" class="level2" data-number="14.1"><h2 data-number="14.1" class="anchored" data-anchor-id="chapter-preparation">
<span class="header-section-number">14.1</span> Chapter preparation</h2>
<section id="introduction-to-the-data-set" class="level3" data-number="14.1.1"><h3 data-number="14.1.1" class="anchored" data-anchor-id="introduction-to-the-data-set">
<span class="header-section-number">14.1.1</span> Introduction to the data set</h3>
<p>For this chapter, we are using open data from <span class="citation" data-cites="przybylski_large-scale_2017">Przybylski &amp; Weinstein (<a href="references.html#ref-przybylski_large-scale_2017" role="doc-biblioref">2017</a>)</span>. The abstract of their article is:</p>
<blockquote class="blockquote">
<p>Although the time adolescents spend with digital technologies has sparked widespread concerns that their use might be negatively associated with mental well-being, these potential deleterious influences have not been rigorously studied. Using a preregistered plan for analyzing data collected from a representative sample of English adolescents (n = 120,115), we obtained evidence that the links between digital-screen time and mental well-being are described by quadratic functions. Further, our results showed that these links vary as a function of when digital technologies are used (i.e., weekday vs.&nbsp;weekend), suggesting that a full understanding of the impact of these recreational activities will require examining their functionality among other daily pursuits. Overall, the evidence indicated that moderate use of digital technology is not intrinsically harmful and may be advantageous in a connected world. The findings inform recommendations for limiting adolescents’ technology use and provide a template for conducting rigorous investigations into the relations between digital technology and children’s and adolescents’ health.</p>
</blockquote>
<p>In summary, this was a large-scale study that found support for the “Goldilocks” hypothesis among adolescents: that there is a “just right” amount of screen time, such that any amount more or less than this amount is associated with lower well-being. This was a huge survey study: the data contain responses from over 120,000 participants! In this chapter, we will look at whether the relationship between screen time and well-being is moderated by participants’ (self-reported) gender.</p>
<p>The outcome/dependant variable used in the study was the <a href="https://warwick.ac.uk/fac/med/research/platform/wemwbs/">Warwick-Edinburgh Mental Well-Being Scale (WEMWBS)</a>. This is a 14-item scale with 5 response categories, summed together to form a single score ranging from 14-70.</p>
<p><span class="citation" data-cites="przybylski_large-scale_2017">Przybylski &amp; Weinstein (<a href="references.html#ref-przybylski_large-scale_2017" role="doc-biblioref">2017</a>)</span> looked at multiple measures of screen time, but we will be focusing on smartphone use. They found that decrements in well-being started to appear when respondents reported more than one hour of weekly smartphone use. Our research question is: Does the negative association between hours of use and well-being (beyond the one-hour point) differ for boys and girls?</p>
</section><section id="organising-your-files-and-project-for-the-chapter" class="level3" data-number="14.1.2"><h3 data-number="14.1.2" class="anchored" data-anchor-id="organising-your-files-and-project-for-the-chapter">
<span class="header-section-number">14.1.2</span> Organising your files and project for the chapter</h3>
<p>Before we can get started, you need to organise your files and project for the chapter, so your working directory is in order.</p>
<ol type="1">
<li><p>In your folder for research methods and the book <code>ResearchMethods1_2/Quant_Fundamentals</code>, create a new folder called <code>Chapter_14_multiple_regression</code>. Within <code>Chapter_14_multiple_regression</code>, create two new folders called <code>data</code> and <code>figures</code>.</p></li>
<li><p>Create an R Project for <code>Chapter_14_multiple_regression</code> as an existing directory for your chapter folder. This should now be your working directory.</p></li>
<li><p>Create a new R Markdown document and give it a sensible title describing the chapter, such as <code>14 Multiple Regression</code>. Delete everything below line 10 so you have a blank file to work with and save the file in your <code>Chapter_14_multiple_regression</code> folder.</p></li>
<li>
<p>For this chapter, there are three data files you need. Please save the following files:</p>
<ul>
<li><p><a href="data/Przybylski_2017_participants.csv">Przybylski_2017_participants.csv</a>.</p></li>
<li><p><a href="data/Przybylski_2017_screentime.csv">Przybylski_2017_screentime.csv</a></p></li>
<li><p><a href="data/Przybylski_2017_wellbeing.csv">Przybylski_2017_wellbeing.csv</a></p></li>
</ul>
</li>
</ol>
<p>Right click the link and select “save link as”, or clicking the link will save the files to your Downloads. Make sure that you save the files as “.csv”. Save or copy the files to your <code>data/</code> folder within <code>Chapter_14_multiple_regression</code>.</p>
<p>You are now ready to start working on the chapter!</p>
</section><section id="mulregression-a1" class="level3" data-number="14.1.3"><h3 data-number="14.1.3" class="anchored" data-anchor-id="mulregression-a1">
<span class="header-section-number">14.1.3</span> Activity 1 - Load the packages and read the data</h3>
<p>As the first activity, try and test yourself by completing the following task list.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try this
</div>
</div>
<div class="callout-body-container callout-body">
<p>To prepare for wrangling the data, complete the following tasks:</p>
<ol type="1">
<li>
<p>Load the following packages (one of these is new, so revisit <a href="01-programming-basics.html#install-tidy">Chapter 1</a> if you need a refresher of installing R packages, but remember not to install packages on the university computers / online server):</p>
<ul>
<li><p><pkg>pwr</pkg></p></li>
<li><p><pkg>sjPlot</pkg></p></li>
<li><p><pkg>performance</pkg></p></li>
<li><p><pkg>tidyverse</pkg></p></li>
</ul>
</li>
<li><p>Read the three data files to the following object names to be consistent with the tasks below.</p></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># load packages here</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>?</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># read the three data files </span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># this should be Przybylski_2017_participants.csv</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>pinfo <span class="ot">&lt;-</span> ?</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># this should be Przybylski_2017_wellbeing.csv</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>wellbeing <span class="ot">&lt;-</span> ?</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co"># this should be Przybylski_2017_screentime.csv</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>screen <span class="ot">&lt;-</span> ?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You should have the following in a code chunk:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># load packages here</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">library</span>(pwr)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">library</span>(performance)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># read the three data files </span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># this should be Przybylski_2017_participants.csv</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>pinfo <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/Przybylski_2017_participants.csv"</span>)</span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co"># this should be Przybylski_2017_wellbeing.csv</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>wellbeing <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/Przybylski_2017_wellbeing.csv"</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co"># this should be Przybylski_2017_screentime.csv</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>screen <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/Przybylski_2017_screentime.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="mulregression-a2" class="level3" data-number="14.1.4"><h3 data-number="14.1.4" class="anchored" data-anchor-id="mulregression-a2">
<span class="header-section-number">14.1.4</span> Activity 2 - Explore the data</h3>
<p>Take a look at the resulting tibbles <code>pinfo</code>, <code>wellbeing</code>, and <code>screen</code>. Use functions like <code>glimpse()</code> to look at what the data frames contain.</p>
<ul>
<li><p>The <code>pinfo</code> data has information on the participant’s background.</p></li>
<li><p>The <code>wellbeing</code> data has information from the well-being questionnaire.</p></li>
<li>
<p>The <code>screen</code> data has information about screen time use on weekends (variables ending with <code>we</code>) and weekdays (variables ending with <code>wk</code>) for four types of activities:</p>
<ul>
<li><p>Using a computer (variables starting with <code>Comph</code>; Q10 on the survey)</p></li>
<li><p>Playing video games (variables starting with <code>Comp</code>; Q9 on the survey)</p></li>
<li><p>Using a smartphone (variables starting with <code>Smart</code>; Q11 on the survey)</p></li>
<li><p>Watching TV (variables starting with <code>Watch</code>; Q8 on the survey).</p></li>
</ul>
</li>
</ul>
<p>If you want more information about these variables, look at the items 8-11 on pages 4-5 of the the <a href="https://osf.io/82ybd/" target="_blank">PDF version of the survey on the authors’ OSF project</a>.</p>
<p>Once you have explored the objects, try and answer the following questions:</p>
<ul>
<li><p>The variable corresponding to <strong>gender</strong> is located in the object named <select class="webex-select"><option value="blank"></option>
<option value="answer">pinfo</option>
<option value="">wellbeing</option>
<option value="">screen</option></select> and this variable is called <input class="webex-solveme nospaces" size="6" data-answer="[&quot;male&quot;]">.</p></li>
<li><p>The well-being data is in <select class="webex-select"><option value="blank"></option>
<option value="">long</option>
<option value="answer">wide</option></select> format and contains observations from <input class="webex-solveme nospaces" size="10" data-answer="[&quot;102580&quot;,&quot;102,580&quot;]"> participants on <input class="webex-solveme nospaces" size="2" data-answer="[&quot;14&quot;]"> items.</p></li>
<li><p>Individual participants in this data set are identified by the variable called <input class="webex-solveme nospaces ignorecase" size="9" data-answer="[&quot;Serial&quot;]">. This variable will allow us to link information across the three tables.</p></li>
<li><p>If you run the function <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> on the three data sets, are there any missing data points? <select class="webex-select"><option value="blank"></option>
<option value="">Yes</option>
<option value="answer">No</option></select></p></li>
</ul></section><section id="mulregression-a3" class="level3" data-number="14.1.5"><h3 data-number="14.1.5" class="anchored" data-anchor-id="mulregression-a3">
<span class="header-section-number">14.1.5</span> Activity 3 - Compute the well-being score for each respondent</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try this
</div>
</div>
<div class="callout-body-container callout-body">
<p>The WEMWBS well-being score is simply the <strong>sum</strong> of all the items.</p>
<p>Wrangle the data to create a new table called <code>wemwbs</code>. The data should have two variables:</p>
<ul>
<li><p><code>Serial</code> - the participant ID.</p></li>
<li><p><code>total_wellbeing</code> - the total WEMWBS score.</p></li>
</ul>
<p>Think about what wrangling steps you need to apply to achieve this.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me some hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>Gather the data and pivot from wide to long.</p></li>
<li><p>Group the data by a variable.</p></li>
<li><p>Summarise the data to calculate the sum score per participant.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You should have the following in a code chunk:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>wemwbs <span class="ot">&lt;-</span> wellbeing <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> WBOptimf<span class="sc">:</span>WBCheer,</span>
<span id="cb3-3"><a href="#cb3-3"></a>               <span class="at">names_to =</span> <span class="st">"var"</span>, </span>
<span id="cb3-4"><a href="#cb3-4"></a>               <span class="at">values_to =</span> <span class="st">"score"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">group_by</span>(Serial) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">summarise</span>(<span class="at">total_wellbeing =</span> <span class="fu">sum</span>(score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>For a sanity check, verify for yourself that the scores all fall in the 14-70 range. <span class="citation" data-cites="przybylski_large-scale_2017">Przybylski &amp; Weinstein (<a href="references.html#ref-przybylski_large-scale_2017" role="doc-biblioref">2017</a>)</span> reported a mean of 47.52 with a standard deviation of 9.55. Can you reproduce these values?</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You should have the following in a code chunk:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>wemwbs <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(total_wellbeing),</span>
<span id="cb4-3"><a href="#cb4-3"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(total_wellbeing),</span>
<span id="cb4-4"><a href="#cb4-4"></a>            <span class="at">min =</span> <span class="fu">min</span>(total_wellbeing),</span>
<span id="cb4-5"><a href="#cb4-5"></a>            <span class="at">max =</span> <span class="fu">max</span>(total_wellbeing))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">47.52189</td>
<td style="text-align: right;">9.546374</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">70</td>
</tr></tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Now, visualise the distribution of <code>tot_wellbeing</code> in a histogram using <pkg>ggplot2</pkg>. The distribution of well-being scores is <select class="webex-select"><option value="blank"></option>
<option value="">symmetric</option>
<option value="answer">negatively skewed</option>
<option value="">positively skewed</option></select>.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You should have the following in a code chunk:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>wemwbs <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> total_wellbeing)) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="14-multiple-regression_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="activity-4---wrangle-and-visualise-the-data" class="level3" data-number="14.1.6"><h3 data-number="14.1.6" class="anchored" data-anchor-id="activity-4---wrangle-and-visualise-the-data">
<span class="header-section-number">14.1.6</span> Activity 4 - Wrangle and visualise the data</h3>
<p>Before we move onto the final modelling stages, we can wrangle the data to plot the data like the original article. We can plot the relationship between well-being and hours of technology use, split into four categories of technology (video games, computers, smartphones, TV).</p>
<p>For this step, we are going to give you the code as there are a few new functions we have not taught you about. Make sure as you type the code to question what each line of the code is doing. The functions might be unfamiliar but you should be able to follow what it is doing. We are working with many rows here, so the code might take longer to run than you are used to.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Pivot the screen data longer</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># Separate the variable into the category and day of the week</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># Recode the new variables </span></span>
<span id="cb7-4"><a href="#cb7-4"></a>screen_long <span class="ot">&lt;-</span> screen <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Comph_we<span class="sc">:</span>Watch_wk,</span>
<span id="cb7-6"><a href="#cb7-6"></a>               <span class="at">names_to =</span> <span class="st">"var"</span>, </span>
<span id="cb7-7"><a href="#cb7-7"></a>               <span class="at">values_to =</span> <span class="st">"hours"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">separate</span>(<span class="at">col =</span> var, <span class="co"># split variable name</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>           <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">"day"</span>), <span class="co"># split into two components</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>           <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span>  <span class="co"># split when it sees a _</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_match</span>(variable,</span>
<span id="cb7-12"><a href="#cb7-12"></a>                               <span class="st">"Watch"</span> <span class="sc">~</span> <span class="st">"Watching TV"</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>                               <span class="st">"Comp"</span> <span class="sc">~</span> <span class="st">"Playing Video Games"</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>                               <span class="st">"Comph"</span> <span class="sc">~</span> <span class="st">"Using Computers"</span>,</span>
<span id="cb7-15"><a href="#cb7-15"></a>                               <span class="st">"Smart"</span> <span class="sc">~</span> <span class="st">"Using Smartphone"</span>),</span>
<span id="cb7-16"><a href="#cb7-16"></a>         <span class="at">day =</span> <span class="fu">case_match</span>(day,</span>
<span id="cb7-17"><a href="#cb7-17"></a>                          <span class="st">"wk"</span> <span class="sc">~</span> <span class="st">"Weekday"</span>,</span>
<span id="cb7-18"><a href="#cb7-18"></a>                          <span class="st">"we"</span> <span class="sc">~</span> <span class="st">"Weekend"</span>))</span>
<span id="cb7-19"><a href="#cb7-19"></a></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co"># Join the two data sets together </span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co"># group by three variables</span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co"># calculate the mean well-being score</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>dat_means <span class="ot">&lt;-</span> wemwbs <span class="sc">%&gt;%</span> </span>
<span id="cb7-24"><a href="#cb7-24"></a>  <span class="fu">inner_join</span>(screen_long, </span>
<span id="cb7-25"><a href="#cb7-25"></a>             <span class="at">by =</span> <span class="st">"Serial"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-26"><a href="#cb7-26"></a>  <span class="fu">group_by</span>(variable, </span>
<span id="cb7-27"><a href="#cb7-27"></a>           day, </span>
<span id="cb7-28"><a href="#cb7-28"></a>           hours) <span class="sc">%&gt;%</span></span>
<span id="cb7-29"><a href="#cb7-29"></a>  <span class="fu">summarise</span>(<span class="at">mean_wellbeing =</span> <span class="fu">mean</span>(total_wellbeing))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now have data at the group level rather than per participant. Each row of <code>dat_means</code> is a value for mean well-being split by each level of variable (technology type), day (weekday or weekend), and hours of technology use. If you run the following code, we get a line graph showing the relationship split between technology type and day.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>dat_means <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hours, <span class="at">y =</span> mean_wellbeing, <span class="at">linetype =</span> day)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Hours of Technology Use"</span>,</span>
<span id="cb8-8"><a href="#cb8-8"></a>       <span class="at">y =</span> <span class="st">"Mean Well-Being Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="14-multiple-regression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The graph shows that smartphone use of more than 1 hour per day is associated with increasingly negative well-being. Note that we have combined the tables using an <code>inner_join()</code>, such that we only include data for which we have observations across the <code>wemwbs</code> and <code>screen_long</code> tables.</p>
<p>In the next step, we are going to focus on the smartphone/well-being relationship for our multiple linear regression demonstration.</p>
</section></section><section id="mulregression-a5" class="level2" data-number="14.2"><h2 data-number="14.2" class="anchored" data-anchor-id="mulregression-a5">
<span class="header-section-number">14.2</span> Multiple linear regression</h2>
<p>Now that we have explored the data, we can start preparing for the analysis. Note that in this analysis, we have:</p>
<ul>
<li><p>A continuous<span class="math inline">\(^*\)</span> outcome: well-being.</p></li>
<li><p>One continuous<span class="math inline">\(^*\)</span> predictor: screen time.</p></li>
<li><p>One categorical predictor: gender.</p></li>
</ul>
<p><span class="math inline">\(^*\)</span>these variables are only quasi-continuous as only discrete values are possible. This returns up to the ordinal dilemma, particularly for the outcome of well-being. However, there are a sufficient number of discrete values that we can treat them as effectively continuous.</p>
<p>We want to estimate two slopes relating screen time to well-being, one for girls and one for boys, and then statistically compare these slopes. So, this problem seems simultaneously like a situation where you would run a regression (to estimate the slopes) but also one where you would need a t-test (to compare two groups). This is the power of regression models as you can look at the interaction between one continuous and one categorical predictor, something that is not possible in factorial ANOVA.</p>
<section id="activity-5---complete-the-final-wrangling-steps" class="level3" data-number="14.2.1"><h3 data-number="14.2.1" class="anchored" data-anchor-id="activity-5---complete-the-final-wrangling-steps">
<span class="header-section-number">14.2.1</span> Activity 5 - Complete the final wrangling steps</h3>
<p>For this analysis, we are going to average weekday and weekend use for smartphones. We need one final round of wrangling to prepare for creating a multiple linear regression model.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try this
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Step 1.</strong> Create a new data object <code>smarttot</code> that has the mean number of hours per day of smartphone use for each participant, averaged over weekends/weekdays. Then filter the data to only include those who use a smart phone for more than one hour per day.</p>
<p>To do this, you will need to:</p>
<ul>
<li><p>Filter the data <code>screen_long</code> to <strong>only</strong> include smartphone use and not other technologies.</p></li>
<li><p>Group the results by the participant ID (<code>Serial</code>).</p></li>
<li><p>Summarise the data to calculate the mean number of hours per participant. Call this variable <code>total_hours</code>.</p></li>
<li><p>Filter the data to only include participants who use a smartphone for more than 1 hour per day.</p></li>
</ul>
<p>The data <code>smarttot</code> should have two variables: <code>Serial</code> (the participant) and <code>total_hours</code>.</p>
<p><strong>Step 2.</strong> Once you have <code>smarttot</code>, combine (join) this data object with the information in <code>wemwbs</code> and <code>pinfo</code>. Call this new object <code>smart_wb</code>. This is the final object you need for the multiple linear regression model.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You should have the following in a code chunk:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>smarttot <span class="ot">&lt;-</span> screen_long <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"Using Smartphone"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">group_by</span>(Serial) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">summarise</span>(<span class="at">total_hours =</span> <span class="fu">mean</span>(hours)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">filter</span>(total_hours <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a>smart_wb <span class="ot">&lt;-</span> smarttot <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="fu">inner_join</span>(wemwbs, </span>
<span id="cb9-9"><a href="#cb9-9"></a>             <span class="at">by =</span> <span class="st">"Serial"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">inner_join</span>(pinfo, </span>
<span id="cb9-11"><a href="#cb9-11"></a>             <span class="at">by =</span> <span class="st">"Serial"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="mulregression-a6" class="level3" data-number="14.2.2"><h3 data-number="14.2.2" class="anchored" data-anchor-id="mulregression-a6">
<span class="header-section-number">14.2.2</span> Activity 6 - Mean-centering variables</h3>
<p>As we discussed in the course materials, when you have continuous variables in a regression model, it is often sensible to transform them by <strong>mean centering</strong>. We covered this in Chapter 8, but it is particularly important in multiple linear regression. You mean center a predictor <code>X</code> by subtracting the mean of the predictor (<code>X_centered = X - mean(X)</code>). This has two useful consequences:</p>
<ul>
<li><p>The model intercept reflects the prediction for <span class="math inline">\(Y\)</span> at the mean value of the predictor variable, rather than at the zero value of the unscaled variable.</p></li>
<li><p>If there are interactions in the model, any lower-order effects can be given the same interpretation as they receive in ANOVA (main effects, rather than simple effects).</p></li>
</ul>
<p>For categorical predictors with two levels, these become coded as -.5 and .5 (because the mean of these two values is 0).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try this
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use <code>mutate()</code> to add two new variables to <code>smart_wb</code>:</p>
<ul>
<li><p><code>total_hours_c</code>: calculated as a mean-centered version of the <code>total_hours</code> predictor</p></li>
<li><p><code>male_c</code>: recoded as -.5 for female and .5 for male, and then converts both <code>male</code> and <code>male_c</code> as factors, so that R knows not to treat them as real numbers.</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You should have the following in a code chunk:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>smart_wb <span class="ot">&lt;-</span> smart_wb <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">mutate</span>(<span class="at">total_hours_c =</span> total_hours <span class="sc">-</span> <span class="fu">mean</span>(total_hours),</span>
<span id="cb10-3"><a href="#cb10-3"></a>         <span class="at">male_c =</span> <span class="fu">case_when</span>(male <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> .<span class="dv">5</span>, </span>
<span id="cb10-4"><a href="#cb10-4"></a>                            male <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="sc">-</span>.<span class="dv">5</span>),</span>
<span id="cb10-5"><a href="#cb10-5"></a>         <span class="at">male_c =</span> <span class="fu">as.factor</span>(male_c),</span>
<span id="cb10-6"><a href="#cb10-6"></a>         <span class="at">male =</span> <span class="fu">as.factor</span>(male))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="mulregression-a8" class="level3" data-number="14.2.3"><h3 data-number="14.2.3" class="anchored" data-anchor-id="mulregression-a8">
<span class="header-section-number">14.2.3</span> Activity 7 - Running the regression</h3>
<p>For the data in <code>smart_wb</code>, use the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function to calculate the multiple regression model:</p>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{3i} + e_i\)</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(Y_i\)</span> is the well-being score for participant <span class="math inline">\(i\)</span>;</p></li>
<li><p><span class="math inline">\(X_{1i}\)</span> is the mean-centered smartphone use variable for participant <span class="math inline">\(i\)</span>;</p></li>
<li><p><span class="math inline">\(X_{2i}\)</span> is gender (-.5 = female, .5 = male);</p></li>
<li><p><span class="math inline">\(X_{3i}\)</span> is the interaction between smartphone use and gender (<span class="math inline">\(= X_{1i} \times X_{2i}\)</span>)</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try this
</div>
</div>
<div class="callout-body-container callout-body">
<p>Save your model to the object <code>ml_model</code>.</p>
<p>Save the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> of your model to the object <code>model_summary</code>.</p>
<p>Print the <code>model_summary</code> to see the results and answer the following questions:</p>
<ul>
<li><p>The interaction between smartphone use and gender is shown by the variable <select class="webex-select"><option value="blank"></option>
<option value="">thours_c</option>
<option value="">male_c</option>
<option value="answer">thours_c:male_c</option></select>, and this interaction was <select class="webex-select"><option value="blank"></option>
<option value="answer">significant</option>
<option value="">non-significant</option></select> at the <span class="math inline">\(\alpha = .05\)</span> level.</p></li>
<li><p>To 2 decimal places, adjusted <span class="math inline">\(R^2\)</span> suggests the overall model explains what percentage of the variance in well-being scores? <input class="webex-solveme nospaces" size="4" data-answer="[&quot;9.38&quot;]"></p></li>
<li><p>The <em>p</em>-value for the overall model fit is <code>&lt;2e-16</code>. Is this statistically significant? <select class="webex-select"><option value="blank"></option>
<option value="answer">Yes</option>
<option value="">No</option></select></p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You should have the following in a code chunk:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>ml_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> total_wellbeing <span class="sc">~</span> total_hours_c <span class="sc">*</span> male_c, </span>
<span id="cb11-2"><a href="#cb11-2"></a>               <span class="at">data =</span> smart_wb)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a>mod_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(ml_model)</span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a>mod_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = total_wellbeing ~ total_hours_c * male_c, data = smart_wb)

Residuals:
    Min      1Q  Median      3Q     Max 
-36.881  -5.721   0.408   6.237  27.264 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             44.86740    0.04478 1001.87   &lt;2e-16 ***
total_hours_c           -0.77121    0.02340  -32.96   &lt;2e-16 ***
male_c0.5                5.13968    0.07113   72.25   &lt;2e-16 ***
total_hours_c:male_c0.5  0.45205    0.03693   12.24   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.135 on 71029 degrees of freedom
Multiple R-squared:  0.09381,   Adjusted R-squared:  0.09377 
F-statistic:  2451 on 3 and 71029 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="activity-8---visualising-interactions" class="level3" data-number="14.2.4"><h3 data-number="14.2.4" class="anchored" data-anchor-id="activity-8---visualising-interactions">
<span class="header-section-number">14.2.4</span> Activity 8 - Visualising interactions</h3>
<p>It is very difficult to understand an interaction from the coefficient alone, so your best bet is visualising the interaction to help you understand the results and communicate your results to your readers.</p>
<p>There is a great package called <pkg>sjPlot</pkg> which takes regression models and helps you plot them in different ways. We will demonstrate plotting interactions, but for further information and options, see the <a href="https://strengejacke.github.io/sjPlot/articles/plot_interactions.html" target="_blank">online documentation</a>.</p>
<p>To plot the interaction, you need the model object (not the summary), specify “pred” as the <code>type</code> as we want to plot predictions, and add the <code>terms</code> you want to plot.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">plot_model</span>(ml_model, </span>
<span id="cb13-2"><a href="#cb13-2"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb13-3"><a href="#cb13-3"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"total_hours_c"</span>, <span class="st">"male_c"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="14-multiple-regression_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>What is the most reasonable interpretation of the interaction?</p>
<div id="radio_PRXKXBHNVO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PRXKXBHNVO" value=""><span>smartphone use harms girls more than boys</span></label><label><input type="radio" autocomplete="off" name="radio_PRXKXBHNVO" value="answer"><span>smartphone use was more negatively associated with wellbeing for girls than for boys</span></label><label><input type="radio" autocomplete="off" name="radio_PRXKXBHNVO" value=""><span>there is no evidence for gender differences in the relationship between smartphone use and well-being</span></label><label><input type="radio" autocomplete="off" name="radio_PRXKXBHNVO" value=""><span>smartphone use harms boys more than girls</span></label>
</div>
<p>This is fine for helping you to interpret your model, but you would need to customise it before adding it into a report. Like <code>afex_plot()</code> we introduced you to in Chapter 13, <code>plot_model()</code> uses <pkg>ggplot2</pkg> in the background. You can add further customisation by adding layers after the initial function.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since <code>plot_model()</code> uses <pkg>ggplot2</pkg>, you can use <code>ggsave()</code> to save your plots and insert them into your work.</p>
</div>
</div>
<p>For example, we can tidy up the axis labels and remove the title, and set a theme.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">plot_model</span>(ml_model, </span>
<span id="cb14-2"><a href="#cb14-2"></a>           <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb14-3"><a href="#cb14-3"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"total_hours_c"</span>, <span class="st">"male_c"</span>)) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total Hours Smartphone Use"</span>,</span>
<span id="cb14-5"><a href="#cb14-5"></a>       <span class="at">y =</span> <span class="st">"Total Well-Being Score"</span>,</span>
<span id="cb14-6"><a href="#cb14-6"></a>       <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="14-multiple-regression_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>For communicating interactions, it is normally better to plot a version using the raw predictors instead of the mean centered versions as the interaction does not change and it will be easier for your readers to understand.</p>
</section><section id="mulregression-a9" class="level3" data-number="14.2.5"><h3 data-number="14.2.5" class="anchored" data-anchor-id="mulregression-a9">
<span class="header-section-number">14.2.5</span> Activity 9 - Assumption checking</h3>
<p>Now it’s time to test those pesky assumptions. The assumptions for multiple regression are the same as simple regression but there is one additional assumption, that of multicollinearity. This is the idea that predictor variables should not be too highly correlated.</p>
<ol type="1">
<li><p>The outcome/DV is a interval/ratio level data.</p></li>
<li><p>The predictor variable is interval/ratio or categorical (with two levels).</p></li>
<li><p>All values of the outcome variable are independent (i.e., each score should come from a different participant).</p></li>
<li><p>The predictors have non-zero variance.</p></li>
<li><p>The relationship between outcome and predictor is linear.</p></li>
<li><p>The residuals should be normally distributed.</p></li>
<li><p>There should be homoscedasticity (homogeneity of variance, but for the residuals).</p></li>
<li><p>Multicollinearity: predictor variables should not be too highly correlated.</p></li>
</ol>
<p>From the work we have done so far, we know that we meet assumptions 1 - 4 and we can use the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function for diagnostic plots, plus <code>check_model()</code> from the <pkg>performance</pkg> package.</p>
<p>One difference from when we used <code>check_model()</code> previously is that rather than just letting it run all the tests it wants, we are going to specify which tests to stop it throwing an error. A word of warning - these assumption tests will take longer than usual to run because it’s such a big data set. The first line of code will run the assumption tests and save it to an object, calling the object name will then display the plots.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>assumptions <span class="ot">&lt;-</span> <span class="fu">check_model</span>(ml_model, </span>
<span id="cb15-2"><a href="#cb15-2"></a>                           <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"vif"</span>, </span>
<span id="cb15-3"><a href="#cb15-3"></a>                                     <span class="st">"qq"</span>, </span>
<span id="cb15-4"><a href="#cb15-4"></a>                                     <span class="st">"normality"</span>, </span>
<span id="cb15-5"><a href="#cb15-5"></a>                                     <span class="st">"linearity"</span>, </span>
<span id="cb15-6"><a href="#cb15-6"></a>                                     <span class="st">"homogeneity"</span>))</span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a>assumptions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-assumption-plots" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="14-multiple-regression_files/figure-html/fig-assumption-plots-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;14.1: Assumption plots from the performance package.</figcaption></figure>
</div>
</div>
</div>
<p>For assumption 5, linearity, we already know from looking at the scatterplot that the relationship is linear, but the residual plot also confirms this.</p>
<p>For assumption 6, normality of residuals, the residuals look good in both plots and this provides an excellent example of why it’s often better to visualise than rely on statistics. With a sample size this large, any statistical diagnostic tests will be highly significant as they are sensitive to sample size.</p>
<p>For assumption 7, homoscedasticity, the plot is missing the reference line. Fun fact, this took us several days of our lives and asking for help on social media to figure out. The reason the line is not there is because the data set is so large that is creates a memory issue. However, if you use the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> version, it does show the reference line.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">plot</span>(ml_model,</span>
<span id="cb16-2"><a href="#cb16-2"></a>     <span class="at">which =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="14-multiple-regression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>It is not perfect, but the reference line is roughly flat to suggest there are no serious issues with homoscedasticity.</p>
<p>Finally, for assumption 8, multicollinearity, the plot also indicates no issues but we can also test this statistically using <code>check_collinearity()</code> to produce VIF (variance inflation factor) and tolerance values.</p>
<p>Essentially, this function estimates how much the variance of a coefficient is “inflated” because of linear dependence with other predictors, i.e., that a predictor is not actually adding any unique variance to the model, it’s just really strongly related to other predictors. <a href="https://statisticalhorizons.com/multicollinearity" target="_blank">You can read more about this online</a>. Thankfully, VIF is not affected by large samples like other statistical diagnostic tests.</p>
<p>There are various rules of thumb, but most converge on a VIF of above 2 - 2.5 for any one predictor being problematic.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">check_collinearity</span>(ml_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 15%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">VIF</th>
<th style="text-align: right;">VIF_CI_low</th>
<th style="text-align: right;">VIF_CI_high</th>
<th style="text-align: right;">SE_factor</th>
<th style="text-align: right;">Tolerance</th>
<th style="text-align: right;">Tolerance_CI_low</th>
<th style="text-align: right;">Tolerance_CI_high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">total_hours_c</td>
<td style="text-align: right;">1.721968</td>
<td style="text-align: right;">1.704219</td>
<td style="text-align: right;">1.740165</td>
<td style="text-align: right;">1.312238</td>
<td style="text-align: right;">0.5807308</td>
<td style="text-align: right;">0.5746582</td>
<td style="text-align: right;">0.5867789</td>
</tr>
<tr class="even">
<td style="text-align: left;">male_c</td>
<td style="text-align: right;">1.035552</td>
<td style="text-align: right;">1.028488</td>
<td style="text-align: right;">1.044369</td>
<td style="text-align: right;">1.017621</td>
<td style="text-align: right;">0.9656682</td>
<td style="text-align: right;">0.9575159</td>
<td style="text-align: right;">0.9723014</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_hours_c:male_c</td>
<td style="text-align: right;">1.716349</td>
<td style="text-align: right;">1.698683</td>
<td style="text-align: right;">1.734463</td>
<td style="text-align: right;">1.310095</td>
<td style="text-align: right;">0.5826319</td>
<td style="text-align: right;">0.5765474</td>
<td style="text-align: right;">0.5886915</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="mulregression-a10" class="level3" data-number="14.2.6"><h3 data-number="14.2.6" class="anchored" data-anchor-id="mulregression-a10">
<span class="header-section-number">14.2.6</span> Activity 10 - Power and effect sizes</h3>
<p>Finally, we will calculate power and an effect size specific to multiple linear regression. Your coefficients represent the effect size for individual variables, but you can summarise the whole regression model with <span class="math inline">\(R^2\)</span> and <span class="math inline">\(f^2\)</span>.</p>
<p>Using your understanding of power analysis from Chapter 10 and the function specific to regression models, calculate the minimum effect size we could reliably observe given our sample size and design but for 99% power and 5% alpha.</p>
<p>Hint: for <code>v</code>, it is the sample size minus u minus 1 (<code>N</code> - <code>u</code> - <code>1</code>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> ?, </span>
<span id="cb18-2"><a href="#cb18-2"></a>            <span class="at">v =</span> ?, </span>
<span id="cb18-3"><a href="#cb18-3"></a>            <span class="at">f2 =</span> <span class="cn">NULL</span>, </span>
<span id="cb18-4"><a href="#cb18-4"></a>            <span class="at">sig.level =</span> ?, </span>
<span id="cb18-5"><a href="#cb18-5"></a>            <span class="at">power =</span> ?)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To 2 decimals, what is the value of <span class="math inline">\(f^2\)</span> the study would be sensitive to? <input class="webex-solveme nospaces" data-tol="0.01" size="0.00" data-answer="[&quot;.00&quot;]"></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You should have the following in a code chunk:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> <span class="dv">3</span>, </span>
<span id="cb19-2"><a href="#cb19-2"></a>            <span class="at">v =</span> <span class="dv">71029</span>, </span>
<span id="cb19-3"><a href="#cb19-3"></a>            <span class="at">f2 =</span> <span class="cn">NULL</span>, </span>
<span id="cb19-4"><a href="#cb19-4"></a>            <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb19-5"><a href="#cb19-5"></a>            <span class="at">power =</span> .<span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Multiple regression power calculation 

              u = 3
              v = 71029
             f2 = 0.0003673651
      sig.level = 0.05
          power = 0.99</code></pre>
</div>
</div>
<p>The study was incredibly sensitive, where they would detect effects of <span class="math inline">\(f^2\)</span> = .0004 with 99% power.</p>
</div>
</div>
</div>
<p>The effect size <span class="math inline">\(f^2\)</span> is a kind of transformed version of <span class="math inline">\(R^2\)</span>. You can calculate it through the equation:</p>
<p><span class="math inline">\(f^2 = \frac{adj R^2}{1 - adj R^2}\)</span></p>
<p>Or as code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>f2 <span class="ot">&lt;-</span> adj_R2<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> adj_R2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try this
</div>
</div>
<div class="callout-body-container callout-body">
<p>Calculate the <span class="math inline">\(f^2\)</span> value from the multiple regression model using one of these methods. Try and use the values directly from the model object to avoid typing in the values.</p>
<p>What is the observed effect size (in <span class="math inline">\(f^2\)</span>) for the study to 2 decimal places? <input class="webex-solveme nospaces" data-tol="0.001" size="3" data-answer="[&quot;0.1&quot;,&quot;.1&quot;]"></p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You should have the following in a code chunk:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>f2 <span class="ot">&lt;-</span> mod_summary<span class="sc">$</span>adj.r.squared<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> mod_summary<span class="sc">$</span>adj.r.squared)</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a>f2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1034697</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Comparing the observed effect size against the effect size the study was sensitive to with 99% power, do you think the study was sufficiently powered? <select class="webex-select"><option value="blank"></option>
<option value="answer">Yes</option>
<option value="">No</option></select></p>
</section></section><section id="mulregression-a11" class="level2" data-number="14.3"><h2 data-number="14.3" class="anchored" data-anchor-id="mulregression-a11">
<span class="header-section-number">14.3</span> Reporting the results of multiple linear regression</h2>
<p>The same as previous chapters like ANOVA and factorial ANOVA, we can use inline code to help with the write-up. First, copy and paste the code below into <strong>white-space</strong> in your R Markdown document and then knit. Note that we enter the <em>p</em>-values manually because of the APA “<em>p</em> &lt; .001” formatting.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>All continuous predictors were mean<span class="sc">-</span>centered and deviation coding was used <span class="cf">for</span> categorical predictors. The results of the regression indicated that the model significantly predicted course <span class="fu">engagement</span> (<span class="fu">F</span>(<span class="st">`</span><span class="at">r mod_summary$fstatistic[2]</span><span class="st">`</span>, <span class="st">`</span><span class="at">r mod_summary$fstatistic[3] %&gt;% round(2)</span><span class="st">`</span>) <span class="ot">=</span> <span class="st">`</span><span class="at">r mod_summary$fstatistic[1] %&gt;% round(2)</span><span class="st">`</span>, p <span class="sc">&lt;</span> .<span class="dv">001</span>, Adjusted <span class="at">R2 =</span> <span class="st">`</span><span class="at">r mod_summary$adj.r.squared %&gt;% round(2)</span><span class="st">`</span>, f<span class="sc">^</span><span class="dv">2</span><span class="sc">^</span> <span class="er">=</span> <span class="st">`</span><span class="at">r f2%&gt;% round(2)</span><span class="st">`</span>), accounting <span class="cf">for</span> <span class="st">`</span><span class="at">r (mod_summary$adj.r.squared %&gt;% round(2))*100</span><span class="st">`</span><span class="sc">% of the variance. Total screen time was a significant negative predictor of wellbeing scores (β = `r ml_model$coefficients[2] %</span><span class="er">&gt;</span><span class="sc">% round(2)`, *p* &lt; .001, as was gender (β = `r ml_model$coefficients[3] %</span><span class="er">&gt;</span><span class="sc">% round(2)`, *p* &lt; .001, with girls having lower wellbeing scores than boys. Importantly, there was a significant interaction between screentime and gender (β = `r ml_model$coefficients[4] %</span><span class="er">&gt;</span>% <span class="fu">round</span>(<span class="dv">2</span>)<span class="st">`</span><span class="at">, *p* &lt; .001), smartphone use was more negatively associated with wellbeing for girls than for boys. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>All continuous predictors were mean-centered and deviation coding was used for categorical predictors. The results of the regression indicated that the model significantly predicted course engagement (F(3, 7.1029^{4}) = 2450.89, p &lt; .001, Adjusted R2 = 0.09, f<sup>2</sup> = 0.1), accounting for 9% of the variance. Total screen time was a significant negative predictor of wellbeing scores (β = -0.77, <em>p</em> &lt; .001, as was gender (β = 5.14, <em>p</em> &lt; .001, with girls having lower wellbeing scores than boys. Importantly, there was a significant interaction between screentime and gender (β = 0.45, <em>p</em> &lt; .001), smartphone use was more negatively associated with wellbeing for girls than for boys.</p>
</blockquote>
</section><section id="mulregression-fin" class="level2" data-number="14.4"><h2 data-number="14.4" class="anchored" data-anchor-id="mulregression-fin">
<span class="header-section-number">14.4</span> End of Chapter</h2>
<p>You are done!</p>
<p>Not just with this chapter but with the R/RStudio component of Research Methods 2. The progress that you have made is truly astonishing. Even if you struggled with R/RStudio and have not quite understood every single line of code, what you are capable of with data wrangling and visualisation alone makes you some of the most highly competitive psychology graduates in the world. Try and think of everything you have learnt from week 1 of Research Methods 1 to now. Hopefully, you have proved to yourself you can do this.</p>
<p>Regardless of whether you continue with quantitative methods and using R/RStudio, remember the more important critical skills that you have learned as part of this process. The next time you see a data set or you see data being talked about in the news, think about all the work that was put into getting the data into the final format. More importantly, think about all the decisions that the researcher needed to make along the way and how that might have affected the outcome.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-przybylski_large-scale_2017" class="csl-entry" role="listitem">
Przybylski, A. K., &amp; Weinstein, N. (2017). A <span>Large</span>-<span>Scale</span> <span>Test</span> of the <span>Goldilocks</span> <span>Hypothesis</span>: <span>Quantifying</span> the <span>Relations</span> <span>Between</span> <span>Digital</span>-<span>Screen</span> <span>Use</span> and the <span>Mental</span> <span>Well</span>-<span>Being</span> of <span>Adolescents</span>. <em>Psychological Science</em>, <em>28</em>(2), 204–215. <a href="https://doi.org/10.1177/0956797616678438">https://doi.org/10.1177/0956797616678438</a>
</div>
</div>
</section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script>
// open rdrr links externally ----

var exlinks = document.querySelectorAll("a[href^='https://rdrr.io']");
var exlink_func = function(){
  window.open(this.href);
  return false;
};
for (var i = 0; i < exlinks.length; i++) {
    exlinks[i].addEventListener('click', exlink_func, false);
}

// visible second sidebar in mobile ----

function move_sidebar() {
  var toc = document.getElementById("TOC");
  var small_sidebar = document.querySelector("#quarto-sidebar .sidebar-menu-container");
  var right_sidebar = document.getElementById("quarto-margin-sidebar");

  if (window.innerWidth < 768) {
    small_sidebar.append(toc);
  } else {
    right_sidebar.append(toc);
  }
}
move_sidebar();
window.onresize = move_sidebar;
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./13-factorial-anova.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./16-analysis-journeys.html" class="pagination-link">
        <span class="nav-page-text">Data Analysis Journeys</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">CC-BY (2024) James Bartlett &amp; Wil Toivo</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>