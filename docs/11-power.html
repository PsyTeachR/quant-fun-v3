<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Materials for the MSc Conversion Research Methods 1 and 2 courses at the University of Glasgow School of Psychology &amp; Neuroscience.">
<title>Fundamentals of Quantitative Analysis - 10&nbsp; Power and Effect Sizes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./12-missing-data.html" rel="next">
<link href="./10-t-tests.html" rel="prev">
<link href="./images/logos/logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">
<link rel="stylesheet" href="include/booktem.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/glossary.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11-power.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Effect Sizes</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Fundamentals of Quantitative Analysis</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-foreword.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foreword</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-programming-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Programming basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-intro-to-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Intro to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-loading-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Starting with data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-wrangling-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data wrangling 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-wrangling-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data wrangling 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-wrangling-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Wrangling 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-data-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Intro to Data Visualisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Correlations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-t-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">t-tests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-power.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Effect Sizes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-missing-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Screening Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">One-way ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-factorial-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Multiple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a-installing-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Installing <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a1-updating-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Updating packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a2-additional-learning-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a3-How-to-cite-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Citing R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-b-symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Symbols</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-d-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-y-license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#designing-studies" id="toc-designing-studies" class="nav-link active" data-scroll-target="#designing-studies"><span class="header-section-number">10.1</span> Designing Studies</a></li>
  <li><a href="#effect-size-by-hand" id="toc-effect-size-by-hand" class="nav-link" data-scroll-target="#effect-size-by-hand"><span class="header-section-number">10.2</span> Effect Size By Hand</a></li>
  <li>
<a href="#power-calculations" id="toc-power-calculations" class="nav-link" data-scroll-target="#power-calculations"><span class="header-section-number">10.3</span> Power Calculations</a>
  <ul class="collapse">
<li><a href="#t-tests" id="toc-t-tests" class="nav-link" data-scroll-target="#t-tests"><span class="header-section-number">10.3.1</span> t-tests</a></li>
  <li><a href="#correlations" id="toc-correlations" class="nav-link" data-scroll-target="#correlations"><span class="header-section-number">10.3.2</span> Correlations</a></li>
  <li><a href="#effect-sizes-in-published-research" id="toc-effect-sizes-in-published-research" class="nav-link" data-scroll-target="#effect-sizes-in-published-research"><span class="header-section-number">10.3.3</span> Effect Sizes in Published Research</a></li>
  </ul>
</li>
  <li><a href="#power-fin" id="toc-power-fin" class="nav-link" data-scroll-target="#power-fin"><span class="header-section-number">10.4</span> Finished!</a></li>
  <li><a href="#test-yourself" id="toc-test-yourself" class="nav-link" data-scroll-target="#test-yourself"><span class="header-section-number">10.5</span> Test Yourself</a></li>
  <li><a href="#power-sols" id="toc-power-sols" class="nav-link" data-scroll-target="#power-sols"><span class="header-section-number">10.6</span> Activity solutions</a></li>
  <li><a href="#words-from-this-chapter" id="toc-words-from-this-chapter" class="nav-link" data-scroll-target="#words-from-this-chapter"><span class="header-section-number">10.7</span> Words from this Chapter</a></li>
  <li>
<a href="#additional-information" id="toc-additional-information" class="nav-link" data-scroll-target="#additional-information"><span class="header-section-number">10.8</span> Additional Information</a>
  <ul class="collapse">
<li><a href="#a-blog-on-how-to-choose-an-effect-size-of-interest" id="toc-a-blog-on-how-to-choose-an-effect-size-of-interest" class="nav-link" data-scroll-target="#a-blog-on-how-to-choose-an-effect-size-of-interest"><span class="header-section-number">10.8.1</span> A blog on how to choose an effect size of interest</a></li>
  <li><a href="#a-blog-on-interpreting-and-writing-up-power" id="toc-a-blog-on-interpreting-and-writing-up-power" class="nav-link" data-scroll-target="#a-blog-on-interpreting-and-writing-up-power"><span class="header-section-number">10.8.2</span> A blog on interpreting and writing up power</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Effect Sizes</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Up until now we have mainly spent time on data-wrangling, understanding probability, visualising our data, and more recently, running inferential tests, i.e.&nbsp;t-tests. In the lectures, however, you have also started to learn about additional aspects of inferential testing and trying to reduce certain types of error in your analyses. It is this balance of minimising error in our inferential statistics that we will focus on today.</p>
<p>First thing to remember is that, in the branch of statistics we are using here, that is Null Hypothesis Significance Testing (NHST), there are two types of <a class="glossary">hypotheses<span class="def"></span></a>, and what you are trying to establish is the <a class="glossary">probability<span class="def"></span></a> of the null hypothesis not being accepted. Those two hypotheses are:</p>
<ul>
<li>The <strong>null hypothesis</strong> which states that the compared values <strong>are equivalent</strong> and, when referring to means, is written as: <span class="math inline">\(H_0: \mu_1 = \mu_2\)</span>
</li>
<li>And the <strong>alternative hypothesis</strong> which states that the compared values <strong>are not equivalent</strong> and, when referring to means, is written as: <span class="math inline">\(H_1: \mu_1 \ne \mu_2\)</span>.</li>
</ul>
<p>Now, each decision about a hypothesis is prone to some degree of error and, as you will learn, the two main types of error that we worry about in Psychology are:</p>
<ul>
<li>
<strong>Type I error</strong> - or <a class="glossary">false positive<span class="def"></span></a>, is the probability of rejecting the null hypothesis when it should not be rejected (otherwise called <a class="glossary">alpha<span class="def">The threshold chosen in Neyman-Pearson hypothesis testing to distinguish test results that lead to the decision to reject the null hypothesis, or not, based on the desired upper bound of the Type 1 error rate. An alpha level of 5% it most commonly used, but other alpha levels can be used as long as they are determined and preregistered by the researcher before the data is analyzed.</span></a> or <span class="math inline">\(\alpha\)</span>). In other words, you conclude that there is a real “effect” when in fact there is no effect. The field standard rate of acceptable false positives is <span class="math inline">\(\alpha = .05\)</span> meaning that in theory 1 in 20 studies may be a false positive.</li>
<li>
<strong>Type II error</strong> - or <a class="glossary">false negative<span class="def"></span></a>, is the probability of retaining the null hypothesis when it is false (otherwise called <a class="glossary">beta<span class="def"></span></a> or <span class="math inline">\(\beta\)</span>). In other words, you conclude that there was no real “effect” when in fact there was one. The field standard rate of acceptable false negatives is <span class="math inline">\(\beta = .2\)</span> meaning that in theory 1 in 5 studies may be a false negative.</li>
</ul>
<p>Adding to the ideas of hypotheses and errors, we are going to look at the idea of <strong>power</strong> which you will learn is the long-run probability of correctly rejecting the null hypothesis for a fixed effect size and fixed sample size; i.e.&nbsp;correctly concluding there is an effect when there is a real effect to detect. <a class="glossary">Power<span class="def"></span></a> is calculated as <span class="math inline">\(power = 1-\beta\)</span> and is directly related to the False Negative rate. If the field standard of False Negatives is <span class="math inline">\(\beta = .2\)</span> then the field standard of power should be <span class="math inline">\(power = 1 - .2 = .8\)</span>, for a given effect size and sample size (though some papers, including Registered Reports are often required to have a power of at least <span class="math inline">\(power &gt;= .9\)</span>). As such, <span class="math inline">\(power = .8\)</span> means that the majority of studies should find an effect if there is one to detect, assuming that your study maintains these rates of error and power.</p>
<p>In the past a number of studies have fallen short of the field standard and it is this lack of power that is thought to be a key issue in the <a class="glossary">replication<span class="def"></span></a> crisis. This makes sense because, if you think about it, if previous studies only have a <span class="math inline">\(power = .5\)</span> then they only have a .5 probability of correctly rejecting the null hypothesis. As such there may be a large number of studies where the null hypothesis has been rejected when it should not have been; the field becomes noisy at that point and you are unsure which studies will replicate. It is issues like this that led us to redevelop our courses and why we really want you to understand power as much as possible.</p>
<section id="designing-studies" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="designing-studies">
<span class="header-section-number">10.1</span> Designing Studies</h2>
<p>To reiterate, power is defined as the probability of correctly rejecting the null hypothesis for a fixed effect size and fixed sample size. As such, power is a key decision when you design your study, under the premis that the higher the power of your planned study, the better.</p>
<p>Two relationships you will learn in this chapter are that:</p>
<ul>
<li>for a given sample size and <span class="math inline">\(\alpha\)</span>, the power of your study is higher if the effect you are looking for is assumed to be a large effect as opposed to a small effect; large effects are easier to detect.</li>
<li>and, for a given effect size and <span class="math inline">\(\alpha\)</span>, the power of your study is higher when you increase your sample size.</li>
</ul>
<p>From these relationships we see that, because you have little control over the size of the effect you are trying to detect (it lives in the real world which you don’t control), you can instead increase the power of your study by increasing the size of your sample (and also reducing sources of noise and measurement error in your study). As such, when planning a study, any good researcher will consider the following four key elements - and we thank Dr Ian Walker (University of Bath) for the excellent acronym - the <strong>APES</strong>:</p>
<ul>
<li>
<strong>alpha</strong> - most commonly thought of as the significance level (i.e., your p-value); usually set at <span class="math inline">\(\alpha = .05\)</span>
</li>
<li>
<strong>power</strong> - the probability of correctly rejecting the null hypothesis for a given effect size and sample size, typically set at <span class="math inline">\(power = .8\)</span>.</li>
<li>
<strong>effect size</strong> - size of the relationship/difference between two variables</li>
<li>
<strong>sample size</strong> - the number of observations (usually, participants, but sometimes also stimuli) in your study.</li>
</ul>
<p>And the beautiful thing is that <strong>if you know three of these elements then you can calculate the fourth</strong>. The two most common calculations prior to a study would be:</p>
<ol type="1">
<li>to determine the appropriate <a class="glossary">sample<span class="def"></span></a> size required to obtain the effect size that you are interested in. That is, prior to the experiment you decide you would be interested in testing for a small, medium, or large effect sizes, so you know everything except the sample size - how many people you need to run in your study. Generally, <strong>the smaller the effect size, the more participants you will need</strong>, assuming power and alpha are held constant at <strong>.8</strong> and <strong>.05</strong> respectively.</li>
</ol>
<ul>
<li>Here you know alpha, the power, and the effect size and you want to know the sample size.</li>
</ul>
<ol start="2" type="1">
<li>to determine the smallest effect size you can reliably detect given your sample size. For example, you know everything except the effect size. For example, say you are taking a <a class="glossary">secondary data<span class="def">data that has been collected already and made available to you to ask research questions of.</span></a> approach and using an open dataset, and you know they have run 100 participants, you can’t add any more participants, but you want to know what is the minimum effect size you could reliably detect in this dataset.</li>
</ol>
<ul>
<li>Here you know alpha, the power, and the sample size and you want to know the smallest effect size you can determine.</li>
</ul>
<p>Hopefully that gives you an idea of how we use power to determine sample sizes for studies - and that the sample size should not just be pulled out of thin air. Both of these approaches described above <strong>a priori power analyses</strong> as you are stating the power level you want <strong>before</strong> (a priori means before) the study - though the second approach of determining the smallest effect size you can determine based on a known sample size is also referred to as a <strong>sensitivity power analysis</strong>. However, you may now be thinking though, if everything is connected, then can we use the effect size from our study and the sample size to determine the power of the study after we have run it? No! Well, you can but it would be wrong to do so. This is actually called <strong>Observed</strong> or <strong>Post-Hoc</strong> power and most papers would discourage you from calculating it on the grounds that the effect size you are using is not the true effect size of the population you are interested in; it is just the effect size of your sample. As such any indication of power from this analysis is misleading. Avoid doing this. You can read more about why, here, in your own time if you like: <a href="http://daniellakens.blogspot.com/2014/12/observed-power-and-what-to-do-if-your.html">Lakens (2014) Observed Power, and what to do if your editor asks for post-hoc power analyses</a>. In brief, Observed Power conflates the effect size of the sample with the effect size within the population and those two are not the same. Stick to using only a priori power analyses approaches and use them to determine your required sample size or achievable reliable effect size.</p>
<p>So let’s jump into this a bit now and start running some analyses to help further our understanding of alpha, power, effect sizes and sample size! We will start by looking at effect sizes, before moving on to calculating power.</p>
</section><section id="effect-size-by-hand" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="effect-size-by-hand">
<span class="header-section-number">10.2</span> Effect Size By Hand</h2>
<p>There are a number of different “effect sizes” that you can choose to calculate but a common one for t-tests, as we have seen previously, is <strong>Cohen’s d</strong>: the standardised difference between two means (in units of SD) and is written as d = effect-size-value. The key point is that Cohen’s d is a standardised difference, meaning that it can be used to compare against other studies regardless of how the measurement was made. Take for example height differences in men and women which is estimated at about 5 inches (12.7 cm). That in itself is an effect size, but it is an unstandardised effect size in that for every sample that you test, that difference is dependent on the measurement tools, the measurement scale, and the errors contained within them (Note: ask Helena about the time she photocopied some rulers). As such using a standardised effect size allows you to make comparisons across studies regardless of measurement error. In standardised terms, the height difference above is considered a medium effect size (d = 0.5) which Cohen (1988, as cited by Schafer and Schwarz (2019)) defined as representing “an effect likely to be visible to the naked eye of a careful observer”. Cohen (1988) in fact stated three sizes of Cohen’s d that people could use as a guide:</p>
<p><br></p>
<table class="table">
<thead><tr class="header">
<th style="text-align: center;">Effect size</th>
<th style="text-align: center;">Cohen’s d value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">small to medium</td>
<td style="text-align: center;">.2 to .5</td>
</tr>
<tr class="even">
<td style="text-align: center;">medium to large</td>
<td style="text-align: center;">.5 to .8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">large</td>
<td style="text-align: center;">&gt; .8</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>You may wish to read this paper later about different effect sizes in psychology - <a href="https://www.frontiersin.org/articles/10.3389/fpsyg.2019.00813/full" target="_blank">Schafer and Schwarz (2019) The Meaningfulness of Effect Sizes in Psychological Research: Differences Between Sub-Disciplines and the Impact of Potential Biases</a>.</p>
<p>The thing to note is that the formula is slightly different depending on the type of t-test used and it can sometimes change depending on who you read. For this worksheet, let’s go with the following formulas:</p>
<ul>
<li>One-sample t-test &amp; paired-sample t-test:</li>
</ul>
<p><span class="math display">\[d = \frac{t}{\sqrt{N}}\]</span></p>
<ul>
<li>Independent t-test:</li>
</ul>
<p><span class="math display">\[d = \frac{2 \times t}{\sqrt{df}}\]</span></p>
<p>Let’s now try out some calculations. We will start with just looking at effect sizes from t-tests before calculating power in later tasks.</p>
<section id="power-a1" class="level4" data-number="10.2.0.1"><h4 data-number="10.2.0.1" class="anchored" data-anchor-id="power-a1">
<span class="header-section-number">10.2.0.1</span> Activity 1: Set-up</h4>
<ul>
<li>Open RStudio and set the working directory to your chapter folder. Ensure the environment is clear.
<ul>
<li>If you’re using the Rserver, avoid a number of issues by restarting the session - click <code>Session</code> - <code>Restart R</code>
</li>
</ul>
</li>
<li>Open a new R Markdown document and save it in your working directory. Call the file “APES”.</li>
<li>Delete the default R Markdown welcome text and insert a new code chunk that loads the following packages, in this specific order, using the <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> function. Remember the solutions if needed.
<ul>
<li>Load the packages in this order, <code>pwr</code>, and <code>tidyverse</code>
</li>
<li>we have not used the <code>pwr</code> package before so you will likely need to install them using <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code>. Remember though that you should only do this on your own machine and only in the console window. If you are using the RServer you will not need to install them.</li>
</ul>
</li>
</ul></section><section id="power-a2" class="level4" data-number="10.2.0.2"><h4 data-number="10.2.0.2" class="anchored" data-anchor-id="power-a2">
<span class="header-section-number">10.2.0.2</span> Activity 2: Effect size from a one-sample t-test</h4>
<ul>
<li>You run a one-sample t-test and discover a significant effect, t(25) = 3.24, p &lt; .05. Using the above formulas, calculate <code>d</code> and determine whether the effect size is small, medium or large.</li>
</ul>
<div class="webex-solution">
<button>
Helpful hint
</button>
<div class="cell" data-layout-align="center">
<ul>
<li>Use the appropriate formula from above for the one-sample t-tests.</li>
<li>You have been given a t-value and df (degrees of freedom), you still need to determine <code>n</code> before you calculate <code>d</code>.</li>
<li>According to Cohen (1988), the effect size is small (.2 to .5), medium (.5 to .8) or large (&gt; .8).</li>
</ul>
</div>
</div>
<p>Answering the following questions to check your answers. The solutions are at the bottom if you need them:</p>
<ul>
<li>Enter, in digits, how many people were run in this study: <input class="webex-solveme nospaces" size="2" data-answer="[&quot;26&quot;]">
</li>
<li>Which of these codes is the appropriate calculation of <code>d</code> in this instance:<select class="webex-select"><option value="blank"></option>
<option value="answer">d = t/sqrt(N)</option>
<option value="">d = 2t/sqrt(df)</option></select>
</li>
<li>Enter the correct value of <code>d</code> for this analysis rounded to 2 decimal places: <input class="webex-solveme nospaces" size="4" data-answer="[&quot;0.64&quot;,&quot;.64&quot;]">
</li>
<li>According to Cohen (1988), the effect size for this t-test would probably be considered: <select class="webex-select"><option value="blank"></option>
<option value="">small to medium</option>
<option value="answer">medium to large</option>
<option value="">large</option></select>
</li>
</ul></section><section id="power-a3" class="level4" data-number="10.2.0.3"><h4 data-number="10.2.0.3" class="anchored" data-anchor-id="power-a3">
<span class="header-section-number">10.2.0.3</span> Activity 3: Effect size from between-subjects t-test</h4>
<ul>
<li>You run a between-subjects t-test and discover a significant effect, t(30) = 2.9, p &lt; .05. Calculate <code>d</code> and determine whether the effect size is small, medium or large.</li>
</ul>
<div class="webex-solution">
<button>
Helpful hint
</button>
<div class="cell" data-layout-align="center">
<ul>
<li>Use the appropriate formula above for between-subjects t-tests.</li>
<li>According to Cohen (1988), the effect size is small (.2 to .5), medium (.5 to .8) or large (&gt; .8).</li>
</ul>
</div>
</div>
<p>Answer the following questions to check your answers. The solutions are at the bottom if you need them:</p>
<ul>
<li>Enter, in digits, how many people were run in this study: <input class="webex-solveme nospaces" size="2" data-answer="[&quot;32&quot;]">
</li>
<li>Which of these codes is the appropriate calculation of <code>d</code> in this instance:<select class="webex-select"><option value="blank"></option>
<option value="">d = t/sqrt(N)</option>
<option value="answer">d = 2t/sqrt(df)</option></select>
</li>
<li>Enter the correct value of <code>d</code> for this analysis rounded to 2 decimal places: <input class="webex-solveme nospaces" size="4" data-answer="[&quot;1.06&quot;]">
</li>
<li>According to Cohen (1988), the effect size for this t-test would probably be considered: <select class="webex-select"><option value="blank"></option>
<option value="">small to medium</option>
<option value="">medium to large</option>
<option value="answer">large</option></select>
</li>
</ul></section><section id="power-a4" class="level4" data-number="10.2.0.4"><h4 data-number="10.2.0.4" class="anchored" data-anchor-id="power-a4">
<span class="header-section-number">10.2.0.4</span> Activity 4: t-value and effect size for a between-subjects Experiment</h4>
<ul>
<li><p>You run a between-subjects design study and the descriptives tell you: <strong>Group 1</strong>, M = 10, SD = 1.3, n = 30; <strong>Group 2</strong>, M = 11, SD = 1.7, n = 30. Calculate <code>t</code> and <code>d</code> for this between-subjects experiment.</p></li>
<li><p>Note: the hint contains the appropriate t-test formula if you are unsure.</p></li>
</ul>
<div class="webex-solution">
<button>
Helpful hint
</button>
<div class="cell" data-layout-align="center">
<ul>
<li>Before you can calculate <code>d</code> (using the appropriate formula for a between-subjects experiment), you need to first calculate <code>t</code> using the formula:</li>
</ul>
<p><code>t = (Mean1 - Mean2)/sqrt((var1/n1) + (var2/n2))</code></p>
<ul>
<li>
<code>var</code> stands for variance in the above formula. Variance is not the same as the standard deviation, right? Variance is measured in squared units. So for this equation, if you require variance to calculate <code>t</code> and you have the standard deviation, then you need to remember that <code>var = SD^2</code>.</li>
<li>Now you have your t-value, but for calculating <code>d</code> you also need degrees of freedom. Think about how you would calculate <code>df</code> for a between-subjects experiment, taking <code>n</code> for both Group 1 and Group 2 into account.</li>
<li>Remember that convention is that people report the <code>t</code> and <code>d</code> values as positive.</li>
</ul>
</div>
</div>
<p>Answer the following questions to check your answers. The solutions are at the bottom if you need them:</p>
<ul>
<li><p>Enter the correct <code>t-value</code> for this test, rounded to two decimal places: <input class="webex-solveme nospaces" size="5" data-answer="[&quot;2.56&quot;,&quot;-2.56&quot;]"></p></li>
<li><p>Which of these codes is the appropriate calculation of <code>d</code> in this instance:<select class="webex-select"><option value="blank"></option>
<option value="">d = t/sqrt(N)</option>
<option value="answer">d = 2t/sqrt(df)</option></select></p></li>
<li><p>Based on the above t-value above, enter the correct value of <code>d</code> for this analysis rounded to 2 decimal places: <input class="webex-solveme nospaces" size="4" data-answer="[&quot;.67&quot;,&quot;0.67&quot;]"></p></li>
<li><p>According to Cohen (1988), the effect size for this t-test would probably be described as: <select class="webex-select"><option value="blank"></option>
<option value="">small to medium</option>
<option value="answer">medium to large</option>
<option value="">large</option></select></p></li>
</ul>
<p><strong>Excellent!</strong> Now that you are comfortable with calculating effect sizes, we will look at using them to establish the sample size for a required power. One thing you will realise as we progress is that the true effect size in a population is something we do not know, but we need to justify one for our design. A clever approach is laid out by Daniel Lakens in the blog on the Smallest Effect Size of Interest (SESOI) - you set the smallest effect that you as a researcher would be interested in! This can be determined through theoretical analysis, through previous studies, through pilot studies, or through rules of thumb like Cohen (1988). However, also keep in mind that the lower the effect size, the larger the sample size you will need. Everything is a trade-off.</p>
</section></section><section id="power-calculations" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="power-calculations">
<span class="header-section-number">10.3</span> Power Calculations</h2>
<p>Today we will use the functions <code>pwr.t.test()</code>, <code>pwr.r.test()</code> and <code>pwr.chisq.test</code> from the package <code>pwr</code> to run power calculations for t-tests, correlations and chi-square.</p>
<section id="t-tests" class="level3" data-number="10.3.1"><h3 data-number="10.3.1" class="anchored" data-anchor-id="t-tests">
<span class="header-section-number">10.3.1</span> t-tests</h3>
<p>Remember that for more information on a function, for example <code>pwr.t.test()</code>, simply do <code>?pwr.t.test</code> in the console. Or you can have a look at these webpages later to get an idea (or bad ideas if you spot where they erroneously calculate post-hoc power!):</p>
<ul>
<li>A quick-R summary of the <strong><code>pwr</code></strong> package - <a href="https://www.statmethods.net/stats/power.html" target="_blank">https://www.statmethods.net/stats/power.html</a>
</li>
<li>the <strong><code>pwr</code></strong> package vignette - <a href="https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html" target="_blank"> https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html</a>
</li>
</ul>
<p>From these you will see that <code>pwr.t.test()</code> takes a series of inputs:</p>
<ul>
<li>
<strong>n</strong> - Number of observations/participants, <strong>per group</strong> for the independent samples version, or the <strong>number of subjects or matched pairs</strong> for the paired and one-sample designs.</li>
<li>
<strong>d</strong> - the effect size of interest (Cohen’s d) - difference between the means divided by the pooled standard deviation</li>
<li>
<strong>sig.level</strong> - the significance level (False Positive Rate) or <span class="math inline">\(\alpha\)</span>
</li>
<li>
<strong>power</strong> - the power of test (1 minus False Negative Rate) or <span class="math inline">\(1-\beta\)</span>
</li>
<li>
<strong>type</strong> - the type of t test : <code>one.sample</code>, <code>two.sample</code>, or <code>paired</code>
</li>
<li>
<strong>alternative</strong> - the type of hypothesis; <code>"two.sided", "greater", "less"</code>
</li>
</ul>
<p>And the function works on a leave one out principle. You give it all the information you have and it returns the element you are missing. So, for example, say you needed to know how many people per group (n) you would need to detect an effect size of <code>d = 0.4</code> with <code>power = .8</code>, <code>alpha = .05</code> in a <code>two.sample</code> (between-subjects) t-test on a <code>two.sided</code> hypothesis test.</p>
<section id="power-a5" class="level4" data-number="10.3.1.1"><h4 data-number="10.3.1.1" class="anchored" data-anchor-id="power-a5">
<span class="header-section-number">10.3.1.1</span> Activity 5: <code>pwr.t.test()</code>
</h4>
<ul>
<li>Run the below code:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">pwr.t.test</span>(<span class="at">d =</span> .<span class="dv">4</span>,</span>
<span id="cb1-2"><a href="#cb1-2"></a>           <span class="at">power =</span> .<span class="dv">8</span>,</span>
<span id="cb1-3"><a href="#cb1-3"></a>           <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb1-4"><a href="#cb1-4"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb1-5"><a href="#cb1-5"></a>           <span class="at">type =</span> <span class="st">"two.sample"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output tells you that you would need 99.0803248 people <strong>per condition</strong>. But you only get whole people and we like to be conservative on our estimates so we would actually run 100 <strong>per condition</strong>. That is a lot of people!!!</p>
<p>To make the output of <code>pwr.t.test()</code> easier to work with, we’re going to amend the code to just give us exactly the number that we want.</p>
<ul>
<li>
<code>pluck()</code> will pull out the value from the analysis that we want. e.g.&nbsp;<code>pluck("n")</code> will give us the sample size and <code>pluck("d")</code> will give us the effect size.</li>
<li>
<code><a href="https://rdrr.io/r/base/Round.html">ceiling()</a></code> rounds up to give us the next highest whole number</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">pwr.t.test</span>(<span class="at">d =</span> .<span class="dv">4</span>,</span>
<span id="cb2-2"><a href="#cb2-2"></a>           <span class="at">power =</span> .<span class="dv">8</span>,</span>
<span id="cb2-3"><a href="#cb2-3"></a>           <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a>           <span class="at">type =</span> <span class="st">"two.sample"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="fu">pluck</span>(<span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="fu">ceiling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Note:</strong> <code><a href="https://rdrr.io/r/base/Round.html">ceiling()</a></code> is better to use than <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code> when dealing with people as it always rounds up. For example, <code>ceiling(1.1)</code> gives you 2. <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code> on the other hand is useful for rounding an effect size, for example, to two decimal places - e.g.&nbsp;d = <code>round(.4356, 2)</code> would give you d = 0.44. So use <code><a href="https://rdrr.io/r/base/Round.html">ceiling()</a></code> for sample sizes and <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code> for effect sizes.</p>
</section><section id="power-a6" class="level4" data-number="10.3.1.2"><h4 data-number="10.3.1.2" class="anchored" data-anchor-id="power-a6">
<span class="header-section-number">10.3.1.2</span> Activity 6: Sample size for standard power one-sample t-test</h4>
<ul>
<li>Assuming you are interested in detecting a minimum Cohen’s d of <strong>d = 0.23</strong>, what would be the minimum number of participants you would need in a one-sample t-test, assuming <strong>power = .8</strong>, <span class="math inline">\(\alpha\)</span> <strong>= .05</strong>, on a two-sided hypothesis?</li>
</ul>
<p>Using a pipeline, store the answer as a single, rounded value called <code>sample_size_t</code> (i.e.&nbsp;use <code>pluck() %&gt;% ceiling()</code>).</p>
<div class="webex-solution">
<button>
Helpful hint
</button>
<div class="cell" data-layout-align="center">
<ul>
<li>Use the list of inputs above as a kind of check-list to clearly determine which inputs are known or unknown. This can help you enter the appropriate values to your code.</li>
<li>The structure of the <code>pwr.t.test()</code> would be very similar to the one shown above except two.sample would become one.sample</li>
<li>You will also need to use <code>pluck("n")</code> to help you obtain the sample size and <code>%&gt;% ceiling()</code> to round up to the nearest whole participant.</li>
</ul>
</div>
</div>
<p>Answer the following question to check your answers. The solutions are at the bottom if you need them:</p>
<ul>
<li>Enter the minimum number of participants you would need in this one-sample t-test: <input class="webex-solveme nospaces" size="3" data-answer="[&quot;151&quot;]">
</li>
</ul></section><section id="activity-7-effect-size-from-a-high-power-between-subjects-t-test" class="level4" data-number="10.3.1.3"><h4 data-number="10.3.1.3" class="anchored" data-anchor-id="activity-7-effect-size-from-a-high-power-between-subjects-t-test">
<span class="header-section-number">10.3.1.3</span> Activity 7: Effect size from a high power between-subjects t-test</h4>
<ul>
<li>Assuming you run a between-subjects t-test with 50 participants per group and want a power of .9, what would be the minimum effect size you can reliably detect? Assume standard <span class="math inline">\(\alpha\)</span> and alternative hypothesis settings.</li>
</ul>
<p>Answer the following questions to check your answers. The solutions are at the bottom if you need them:</p>
<ul>
<li>Based on the information given, what will you set <code>type</code> as in the function?
<div id="radio_JZHLRUVWVH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_JZHLRUVWVH" value=""><span>one.sample</span></label><label><input type="radio" autocomplete="off" name="radio_JZHLRUVWVH" value="answer"><span>two.sample</span></label>
</div>
</li>
<li>Based on the output, enter the minimum effect size you can reliably detect in this test, rounded to two decimal places: <input class="webex-solveme nospaces" size="4" data-answer="[&quot;.65&quot;,&quot;0.65&quot;]">
</li>
<li>According to Cohen (1988), the effect size for this t-test is
<div id="radio_DKCXMAWYWP" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_DKCXMAWYWP" value=""><span>small to medium</span></label><label><input type="radio" autocomplete="off" name="radio_DKCXMAWYWP" value="answer"><span>medium to large</span></label><label><input type="radio" autocomplete="off" name="radio_DKCXMAWYWP" value=""><span>large</span></label>
</div>
</li>
<li>Say you run the study and find that the effect size determined is d = 0.50. Given what you know about power, select the statement that is true:
<div id="radio_KOZDXGXPKM" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KOZDXGXPKM" value=""><span>the study is sufficiently powered as the analysis indicates you can detect only effect sizes smaller than d = 0.65</span></label><label><input type="radio" autocomplete="off" name="radio_KOZDXGXPKM" value="answer"><span>the study is underpowered as the analysis indicates you can detect only effect sizes larger than d = 0.65</span></label>
</div>
</li>
</ul></section><section id="uneven-groups" class="level4" data-number="10.3.1.4"><h4 data-number="10.3.1.4" class="anchored" data-anchor-id="uneven-groups">
<span class="header-section-number">10.3.1.4</span> Uneven groups</h4>
<p>There is an additional function that is very worthwhile knowing about called <code>pwr.t2n.test()</code> that allows you to run power analyses for t-tests where there are uneven sample sizes in the two groups. For instance, say you wanted to know the minimum effect size you could determine in a between-subjects t-test where you have 25 participants in one group and 30 participants in the second group. The additional aspect of this function is that instead of <code>n =</code>, you would do:</p>
<ul>
<li>
<code>n1 = ...</code> for the number of people in group 1</li>
<li>
<code>n2 = ...</code> for the number of people in group 2</li>
<li>note that there is no <code>type</code> argument in this function because it has to be two samples.</li>
</ul>
<p>Assuming <span class="math inline">\(\alpha = .05\)</span>, Power = .8, and it is a two-tailed test, you would do:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">pwr.t2n.test</span>(<span class="at">n1 =</span> <span class="dv">25</span>,</span>
<span id="cb3-2"><a href="#cb3-2"></a>             <span class="at">n2 =</span> <span class="dv">30</span>,</span>
<span id="cb3-3"><a href="#cb3-3"></a>             <span class="at">power =</span> .<span class="dv">8</span>,</span>
<span id="cb3-4"><a href="#cb3-4"></a>             <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>             <span class="at">alternative =</span> <span class="st">"two.sided"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">pluck</span>(<span class="st">"d"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.773</code></pre>
</div>
</div>
<p>Meaning that the minimum effect size you could determine would be d = 0.773.</p>
</section></section><section id="correlations" class="level3" data-number="10.3.2"><h3 data-number="10.3.2" class="anchored" data-anchor-id="correlations">
<span class="header-section-number">10.3.2</span> Correlations</h3>
<p>Now, we’re going to do the same thing but for a correlation analysis using <code>pwr.r.test</code>. The structure of this function is very similar to <code>pwr.t.test()</code> and works on the same leave-one-out principle:</p>
<ul>
<li>
<strong>n</strong> - Number of observations</li>
<li>
<strong>r</strong> - Correlation coefficient</li>
<li>
<strong>sig.level</strong> - Significance level (Type I error probability)</li>
<li>
<strong>power</strong> - Power of test (1 minus Type II error probability)</li>
<li>
<strong>alternative</strong> - a character string specifying the alternative hypothesis, must be one of <code>two.sided</code> (default), <code>greater</code> (a positive correlation) or <code>less</code> (a negative correlation).</li>
</ul>
<section id="power-a8" class="level4" data-number="10.3.2.1"><h4 data-number="10.3.2.1" class="anchored" data-anchor-id="power-a8">
<span class="header-section-number">10.3.2.1</span> Activity 8: Sample size for a correlation</h4>
<ul>
<li>Assuming you are interested in detecting a minimum correlation of <strong>r = .4</strong> (in either direction), what would be the minimum number of participants you would need for a correlation analysis, assuming <strong>power = .8</strong>, <span class="math inline">\(\alpha\)</span> <strong>= .05</strong>?</li>
</ul>
<p>Using a pipeline, store the answer as a single, rounded value called <code>sample_size_r</code> (i.e.&nbsp;use <code>pluck() %&gt;% ceiling()</code>).</p>
<ul>
<li>Enter the minimum number of participants you would need in this correlation: <input class="webex-solveme nospaces" size="2" data-answer="[&quot;46&quot;]">
</li>
</ul></section><section id="power-a9" class="level4" data-number="10.3.2.2"><h4 data-number="10.3.2.2" class="anchored" data-anchor-id="power-a9">
<span class="header-section-number">10.3.2.2</span> Activity 9: Effect size for a correlation analysis</h4>
<ul>
<li><p>You run a correlation analysis with 50 participants and the standard power and alpha levels and you have hypothesised a positive correlation, what would be the minimum effect size you can reliably detect? Answer the following questions to check your answers. The solutions are at the bottom if you need them:</p></li>
<li><p>Based on the information given, what will you set <code>alternative</code> as in the function? <select class="webex-select"><option value="blank"></option>
<option value="">two.sided</option>
<option value="answer">greater</option>
<option value="">less</option></select></p></li>
<li><p>Based on the output, enter the minimum effect size you can reliably detect in this test, rounded to two decimal places: <input class="webex-solveme nospaces" size="4" data-answer="[&quot;.34&quot;,&quot;0.34&quot;]"></p></li>
<li><p>According to Cohen (1988), the effect size for this correlation is <select class="webex-select"><option value="blank"></option>
<option value="">small to medium</option>
<option value="answer">medium to large</option>
<option value="">large</option></select></p></li>
<li>
<p>Say you run the study and find that the effect size determined is d = 0.24. Given what you know about power, select the statement that is true:</p>
<div id="radio_LKDQNAKLGP" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LKDQNAKLGP" value=""><span>the study is sufficiently powered as the analysis indicates you can detect only effect sizes smaller than d = 0.24</span></label><label><input type="radio" autocomplete="off" name="radio_LKDQNAKLGP" value="answer"><span>the study is underpowered as the analysis indicates you can detect only effect sizes larger than d = 0.34</span></label>
</div>
</li>
</ul></section></section><section id="effect-sizes-in-published-research" class="level3" data-number="10.3.3"><h3 data-number="10.3.3" class="anchored" data-anchor-id="effect-sizes-in-published-research">
<span class="header-section-number">10.3.3</span> Effect Sizes in Published Research</h3>
<section id="power-a10" class="level4" data-number="10.3.3.1"><h4 data-number="10.3.3.1" class="anchored" data-anchor-id="power-a10">
<span class="header-section-number">10.3.3.1</span> Activity 10: Power of published research</h4>
<p>Thus far we have used hypothetical situations - now go look at the paper on the <a href="https://sites.trinity.edu/osl/data-sets-and-activities/t-test-activities">Open Stats Lab</a> website called Does Music Convey Social Information to Infants? (we have used this dataset in the t-test chapter). You can download the pdf and look at it, but here we will determine the power of the significant t-tests reported in Experiment 1 under the Results section on Pg489. There is a one-sample t-test and a paired-samples t-test to consider, summarised below. Assume testing was at power = .8, alpha = .05. Based on your calculations are either of the stated effects underpowered?</p>
<ol type="1">
<li>one-sample: t(31) = 2.96, p = .006, d = 0.52</li>
<li>paired t-test: t(31) = 2.42, p = .022, d= 0.43</li>
</ol>
<div class="webex-solution">
<button>
Helpful hint
</button>
<div class="cell" data-layout-align="center">
<ul>
<li>To calculate n: <code>n = df + 1</code>.</li>
</ul>
</div>
</div>
<p>Which of the t-tests do you believe to be underpowered? Why do you think this may be? Additional information about this can be found in the solution to task 8 at the end of this activity.</p>
<p><strong>One caveat to Task 10:</strong> We have to keep in mind that here we are looking at single studies using one sample from a potentially huge number of samples within a population. As such there will be a degree of variance in the true effect size within the population regardless of the effect size of one given sample. What that means is we have to be a little bit cautious when making claims about a study. Ultimately the higher the power the better as you can detect smaller effect sizes!</p>
</section></section></section><section id="power-fin" class="level2" data-number="10.4"><h2 data-number="10.4" class="anchored" data-anchor-id="power-fin">
<span class="header-section-number">10.4</span> Finished!</h2>
<p><strong>Great!</strong> Hopefully you are now starting to see the interaction between alpha, power, effect sizes, and sample size. We should always want really high powered studies and depending on the size of the effect we are interested in (small to large), and our <span class="math inline">\(\alpha\)</span> level, this will mean we will need to run more or less participants to make sure our study is well powered. Points to note:</p>
<ul>
<li>Lowering the <span class="math inline">\(\alpha\)</span> level (e.g.&nbsp;.05 to .01) will reduce the power.</li>
<li>Lowering the effect size (e.g.&nbsp;.8 to .2) will reduce the power.</li>
<li>Increasing power (.8 to .9) will require more participants.</li>
</ul>
<p>A high-powered study looking to detect a small effect size at a low alpha will require a large number of participants!</p>
<p>There are additional functions in the <code>pwr</code> package for other types of statistical analyses. We will include these calculates as part of the ANOVA and regression chapters.</p>
<p>If you want more examples of power to reinforce your understanding, go back and calculate the power of the t-tests, correlations, and chi-squares from earlier chapters.</p>
</section><section id="test-yourself" class="level2" data-number="10.5"><h2 data-number="10.5" class="anchored" data-anchor-id="test-yourself">
<span class="header-section-number">10.5</span> Test Yourself</h2>
<ol type="1">
<li>Assuming you were running a between-subjects t-test on secondary data (<span class="math inline">\(\alpha = .05\)</span>, Power = .8, alternative = two-tailed) and that this secondary data has 100 participants in both groups. The smallest effect size, to three decimal places, you could determine with this data is:
<div id="radio_OFDCHNAHFH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_OFDCHNAHFH" value=""><span>d = 0.280</span></label><label><input type="radio" autocomplete="off" name="radio_OFDCHNAHFH" value=""><span>d = 0.281</span></label><label><input type="radio" autocomplete="off" name="radio_OFDCHNAHFH" value="answer"><span>d = 0.398</span></label><label><input type="radio" autocomplete="off" name="radio_OFDCHNAHFH" value=""><span>d = 0.399</span></label>
</div>
</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<p>The code for this test would be:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb5-2"><a href="#cb5-2"></a>           <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb5-3"><a href="#cb5-3"></a>           <span class="at">power =</span> .<span class="dv">8</span>,</span>
<span id="cb5-4"><a href="#cb5-4"></a>           <span class="at">type =</span> <span class="st">"two.sample"</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">pluck</span>(<span class="st">"d"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Meaning that the smallest effect size would be d = 0.39</li>
</ul>
</div>
<ol start="2" type="1">
<li>Assuming you were running a between-subjects t-test on secondary data (<span class="math inline">\(\alpha = .05\)</span>, Power = .8, alternative = two-tailed) and that this secondary data has 60 participants in Group 1 and 40 participants in Group 2. The smallest effect size, to three decimal places, you could determine with this data is:
<div id="radio_GBAUAFYSFN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GBAUAFYSFN" value=""><span>r = .577</span></label><label><input type="radio" autocomplete="off" name="radio_GBAUAFYSFN" value=""><span>d = 0.577</span></label><label><input type="radio" autocomplete="off" name="radio_GBAUAFYSFN" value="answer"><span>d = 0.578</span></label><label><input type="radio" autocomplete="off" name="radio_GBAUAFYSFN" value=""><span>r = .578</span></label>
</div>
</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<p>The code for this test would be:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">pwr.t2n.test</span>(<span class="at">n1 =</span> <span class="dv">60</span>,</span>
<span id="cb6-2"><a href="#cb6-2"></a>           <span class="at">n2 =</span> <span class="dv">40</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>           <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb6-4"><a href="#cb6-4"></a>           <span class="at">power =</span> .<span class="dv">8</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">pluck</span>(<span class="st">"d"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Meaning that the smallest effect size would be d = 0.578</li>
</ul>
</div>
<ol start="3" type="1">
<li>Assuming you ran a correlation on secondary data (<span class="math inline">\(\alpha = .05\)</span>, Power = .8, alternative = two-tailed) and that this secondary data has 50 observations. The smallest effect size, to three decimal places, you could determine with this data is:
<div id="radio_ILNOGROMOB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ILNOGROMOB" value=""><span>r = .276</span></label><label><input type="radio" autocomplete="off" name="radio_ILNOGROMOB" value=""><span>r = .385</span></label><label><input type="radio" autocomplete="off" name="radio_ILNOGROMOB" value="answer"><span>r = .384</span></label><label><input type="radio" autocomplete="off" name="radio_ILNOGROMOB" value=""><span>r = .275</span></label>
</div>
</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<p>The code for this test would be:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">pwr.r.test</span>(<span class="at">n =</span> <span class="dv">50</span>,</span>
<span id="cb7-2"><a href="#cb7-2"></a>           <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb7-3"><a href="#cb7-3"></a>           <span class="at">power =</span> .<span class="dv">8</span>,</span>
<span id="cb7-4"><a href="#cb7-4"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">pluck</span>(<span class="st">"r"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Meaning that the smallest effect size would be r = .384</li>
</ul>
</div>
</section><section id="power-sols" class="level2" data-number="10.6"><h2 data-number="10.6" class="anchored" data-anchor-id="power-sols">
<span class="header-section-number">10.6</span> Activity solutions</h2>
<p>Below you will find the solutions to the above questions. Only look at them after giving the questions a good try and trying to find help on Google or Teams about any issues.</p>
<section id="power-a1sol" class="level4" data-number="10.6.0.1"><h4 data-number="10.6.0.1" class="anchored" data-anchor-id="power-a1sol">
<span class="header-section-number">10.6.0.1</span> Activity 1</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">library</span>(broom)</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="power-a2sol" class="level4" data-number="10.6.0.2"><h4 data-number="10.6.0.2" class="anchored" data-anchor-id="power-a2sol">
<span class="header-section-number">10.6.0.2</span> Activity 2</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>d <span class="ot">&lt;-</span> <span class="fl">3.24</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">25</span> <span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># effect is medium to large; d = .64</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="power-a3sol" class="level4" data-number="10.6.0.3"><h4 data-number="10.6.0.3" class="anchored" data-anchor-id="power-a3sol">
<span class="header-section-number">10.6.0.3</span> Activity 3</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>d <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span><span class="fl">2.9</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">30</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># effect is large; d = 1.06</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="power-a4sol" class="level4" data-number="10.6.0.4"><h4 data-number="10.6.0.4" class="anchored" data-anchor-id="power-a4sol">
<span class="header-section-number">10.6.0.4</span> Activity 4</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>t <span class="ot">=</span> (<span class="dv">10</span> <span class="sc">-</span> <span class="dv">11</span>)<span class="sc">/</span><span class="fu">sqrt</span>((<span class="fl">1.3</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">30</span>) <span class="sc">+</span> (<span class="fl">1.7</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">30</span>))</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>d <span class="ot">=</span> (<span class="dv">2</span><span class="sc">*</span>t)<span class="sc">/</span><span class="fu">sqrt</span>((<span class="dv">30-1</span>) <span class="sc">+</span> (<span class="dv">30-1</span>))</span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co"># t = 2.56</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co"># d = .67</span></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co"># Remember that convention is that people report the t and d as positive.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="power-a6sol" class="level4" data-number="10.6.0.5"><h4 data-number="10.6.0.5" class="anchored" data-anchor-id="power-a6sol">
<span class="header-section-number">10.6.0.5</span> Activity 6</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>sample_size_t <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(<span class="at">d =</span> .<span class="dv">23</span>,</span>
<span id="cb12-2"><a href="#cb12-2"></a>                            <span class="at">power =</span> .<span class="dv">8</span>, </span>
<span id="cb12-3"><a href="#cb12-3"></a>                            <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb12-4"><a href="#cb12-4"></a>                            <span class="at">alternative =</span> <span class="st">"two.sided"</span>, </span>
<span id="cb12-5"><a href="#cb12-5"></a>                            <span class="at">type =</span> <span class="st">"one.sample"</span>) <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">"n"</span>) <span class="sc">%&gt;%</span> <span class="fu">ceiling</span>()</span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a>sample_size_t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 151</p>
</div>
</section><section id="power-a7sol" class="level4" data-number="10.6.0.6"><h4 data-number="10.6.0.6" class="anchored" data-anchor-id="power-a7sol">
<span class="header-section-number">10.6.0.6</span> Activity 7</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="dv">50</span>,</span>
<span id="cb13-2"><a href="#cb13-2"></a>           <span class="at">power =</span> .<span class="dv">9</span>, </span>
<span id="cb13-3"><a href="#cb13-3"></a>           <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb13-4"><a href="#cb13-4"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>, </span>
<span id="cb13-5"><a href="#cb13-5"></a>           <span class="at">type =</span> <span class="st">"two.sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="fu">pluck</span>(<span class="st">"d"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 0.65</p>
</div>
</section><section id="power-a8sol" class="level4" data-number="10.6.0.7"><h4 data-number="10.6.0.7" class="anchored" data-anchor-id="power-a8sol">
<span class="header-section-number">10.6.0.7</span> Activity 8</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>sample_size_r <span class="ot">&lt;-</span> <span class="fu">pwr.r.test</span>(<span class="at">r =</span> .<span class="dv">4</span>, </span>
<span id="cb14-2"><a href="#cb14-2"></a>                            <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb14-3"><a href="#cb14-3"></a>                            <span class="at">power =</span> .<span class="dv">8</span>, </span>
<span id="cb14-4"><a href="#cb14-4"></a>                            <span class="at">alternative =</span> <span class="st">"two.sided"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">pluck</span>(<span class="st">"n"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="fu">ceiling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="power-a9sol" class="level4" data-number="10.6.0.8"><h4 data-number="10.6.0.8" class="anchored" data-anchor-id="power-a9sol">
<span class="header-section-number">10.6.0.8</span> Activity 9</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">pwr.r.test</span>(<span class="at">n =</span> <span class="dv">50</span>,</span>
<span id="cb15-2"><a href="#cb15-2"></a>           <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb15-3"><a href="#cb15-3"></a>           <span class="at">power =</span> .<span class="dv">8</span>, </span>
<span id="cb15-4"><a href="#cb15-4"></a>           <span class="at">alternative =</span> <span class="st">"greater"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">pluck</span>(<span class="st">"r"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 0.344</p>
</div>
</section><section id="power-a10sol" class="level4" data-number="10.6.0.9"><h4 data-number="10.6.0.9" class="anchored" data-anchor-id="power-a10sol">
<span class="header-section-number">10.6.0.9</span> Activity 10</h4>
<p><strong>Achievable Cohen d for Example 1</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">pwr.t.test</span>(<span class="at">power =</span> .<span class="dv">8</span>, </span>
<span id="cb16-2"><a href="#cb16-2"></a>           <span class="at">n =</span> <span class="dv">32</span>, </span>
<span id="cb16-3"><a href="#cb16-3"></a>           <span class="at">type =</span> <span class="st">"one.sample"</span>, </span>
<span id="cb16-4"><a href="#cb16-4"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>, </span>
<span id="cb16-5"><a href="#cb16-5"></a>           <span class="at">sig.level =</span> .<span class="dv">05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>  <span class="fu">pluck</span>(<span class="st">"d"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 0.51</p>
</div>
<ul>
<li>Giving an achievable effect size of 0.51 and they found an effect size of 0.52.</li>
</ul>
<p>This study seems ok as the authors could achieve an effect size as low as .51 and found an effect size at .52</p>
<p><strong>Achievable Cohen d for Example 2</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">pwr.t.test</span>(<span class="at">power =</span> .<span class="dv">8</span>, </span>
<span id="cb17-2"><a href="#cb17-2"></a>           <span class="at">n =</span> <span class="dv">32</span>, </span>
<span id="cb17-3"><a href="#cb17-3"></a>           <span class="at">type =</span> <span class="st">"paired"</span>, </span>
<span id="cb17-4"><a href="#cb17-4"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>, </span>
<span id="cb17-5"><a href="#cb17-5"></a>           <span class="at">sig.level =</span> .<span class="dv">05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="fu">pluck</span>(<span class="st">"d"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 0.51</p>
</div>
<ul>
<li>Giving an achievable effect size of 0.51 and they found an effect size of 0.43.</li>
</ul>
<p>This effect might not be reliable given that the effect size found was much lower than the achievable effect size. The issue here is that the researchers established their sample size based on a previous effect size and not on the minimum effect size that they would find important. If an effect size as small as .4 was important then they should have powered all studies to that level and ran the appropriate n ~52 babies (see below). Flipside of course is that obtaining 52 babies isnt easy; hence why some people consider the Many Labs approach a good way ahead.</p>
<p><strong>ONE CAVEAT</strong> to the above is that before making the assumption that this study is therefore flawed, we have to keep in mind that this is one study using one sample from a potentially huge number of samples within a population. As such there will be a degree of variance in the true effect size within the population regardless of the effect size of one given sample. What that means is we have to be a little bit cautious when making claims about a study. Ultimately the higher the power the better.</p>
<p>Below you could calculate the actual sample size required to achieve a power of .8:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(<span class="at">power =</span> .<span class="dv">8</span>,</span>
<span id="cb18-2"><a href="#cb18-2"></a>                          <span class="at">d =</span> .<span class="dv">4</span>, </span>
<span id="cb18-3"><a href="#cb18-3"></a>                          <span class="at">type =</span> <span class="st">"paired"</span>, </span>
<span id="cb18-4"><a href="#cb18-4"></a>                          <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb18-5"><a href="#cb18-5"></a>                          <span class="at">sig.level =</span> .<span class="dv">05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="fu">pluck</span>(<span class="st">"n"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="fu">ceiling</span>()</span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a>sample_size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 52</p>
</div>
<ul>
<li>Suggesting a sample size of n = 52 would be appropriate.</li>
</ul></section></section><section id="words-from-this-chapter" class="level2" data-number="10.7"><h2 data-number="10.7" class="anchored" data-anchor-id="words-from-this-chapter">
<span class="header-section-number">10.7</span> Words from this Chapter</h2>
<p>Below you will find a list of words that were used in this chapter that might be new to you in case it helps to have somewhere to refer back to what they mean. The links in this table take you to the entry for the words in the <a href="https://psyteachr.github.io/glossary/" target="_blank">PsyTeachR Glossary</a>. Note that the Glossary is written by numerous members of the team and as such may use slightly different terminology from that shown in the chapter.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">alpha</td>
<td style="text-align: left;">The threshold chosen in Neyman-Pearson hypothesis testing to distinguish test results that lead to the decision to reject the null hypothesis, or not, based on the desired upper bound of the Type 1 error rate. An alpha level of 5% it most commonly used, but other alpha levels can be used as long as they are determined and preregistered by the researcher before the data is analyzed.</td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">false negative</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">false positive</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">hypothesis</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">power</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">probability</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">replicability</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sample</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">secondary data</td>
<td style="text-align: left;">data that has been collected already and made available to you to ask research questions of.</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="additional-information" class="level2" data-number="10.8"><h2 data-number="10.8" class="anchored" data-anchor-id="additional-information">
<span class="header-section-number">10.8</span> Additional Information</h2>
<section id="a-blog-on-how-to-choose-an-effect-size-of-interest" class="level3" data-number="10.8.1"><h3 data-number="10.8.1" class="anchored" data-anchor-id="a-blog-on-how-to-choose-an-effect-size-of-interest">
<span class="header-section-number">10.8.1</span> A blog on how to choose an effect size of interest</h3>
<p>A really quick analogy from Ian Walker’s “Research Methods and statistics”, is say your test is not a stats test but a telescope. And say you have a telescope that is specifically designed only for spotting animals that are the size of elephants or larger (similar to saying a cohens d of .8 or greater for example - very big effect). If your telescope can only reliably detect something down to the size of an elephant but when you look through it you see something smaller that you think might be a mouse, you can’t say that the “object”” is definitely is a mouse as you don’t have enough power in your telescope - it is too blurry. But likewise you can’t rule out that it isn’t a mouse as that would be something you don’t know for sure - both of these are true because your telescope was only designed to spot things the size of an elephant or larger. You only bought a telescope that was able to spot elephants because that was all your were interested in. Had you been interested in spotting mice you would have had to have bought a more powerful telescope. And that is the point of Lakens’ SESOI (Smallest Effect Size of Interest) blog mentioned at the start - you power to the minimum effect size (minimum object size) you would be interested in. This is why it is imperative that you decide before your study what effect you are interested in - and you can base this on previous literature or theory.</p>
</section><section id="a-blog-on-interpreting-and-writing-up-power" class="level3" data-number="10.8.2"><h3 data-number="10.8.2" class="anchored" data-anchor-id="a-blog-on-interpreting-and-writing-up-power">
<span class="header-section-number">10.8.2</span> A blog on interpreting and writing up power</h3>
<p>A few points on interpreting power to consolidate things a bit. Firstly, it is great that you are now thinking about power and effect sizes in the first place. It is important that this becomes as second nature as thinking about the design of your study and in future years and future studies the first question you should ask yourself when designing your study/secondary analysis is what size are my APES - Alpha, Power, Effect Size and Sample. And remember that a priori power analysis is the way ahead. The power and alpha are determined in advance of the study and you are using them to determine the effect size or the sample size.</p>
<p>Power is stated more and more commonly again in papers now and you will start to notice it in the Methods or Results sections. You will see something along the lines of “Based on a power =….. and alpha =…., given we had X voices in our sample, a power analysis (pwr package citation) revealed d = …… as the minimum effect sizes we could reliably determine.”</p>
<p>But how do you interpret a study in terms of power? Well, lets say you run a power analysis for a t-test (or for a correlation), and you set the smallest effect size of interest as d = .4 (or the equivalent r-value). If you then run your analysis and find d = .6 and the effect is significant, then your study had enough power to determine this effect. The effect that you found was bigger than the effect you could have found. You can have some confidence that you have a reliable effect at that given power and alpha values. However, say that instead of d = .6 you found a significant effect but with an effect size just below .4, say d = .3 - the effect size you found is smaller than the smallest effect you could reliably find. In this case you have to be cautious as you are still unclear as to whether there actually is an effect or whether you have found an effect by chance due to your study not having enough power to reliably detect an effect size that small. You can’t say for sure that there is an effect or that there isn’t an effect. You need to consider both stances in your write up. Remember though that you have sampled a population, so how representative that sample is of your population will also influence the validity of your power. Each sample will give a slightly different effect size.</p>
<p>Alternatively, and probably quite likely in many degree projects due to time constraints, say you find a non-significant effect at an effect size smaller than what you predicted; say you find a non-significant effect with an effect size of d = .2 and your power analysis said you could only reliably detect an effect as small as d = .4. The issue you have here is that you can’t determine solely based on this study if you a) have a non-significant effect because you are under powered or b) that you have a non-significant effect because there is actually no effect in the first place. Again in your discussion you would need to consider both stances. What you can however say is that the effect that you were looking for is not any bigger than d = 0.4. That is still useful information. Ok you don’t know how small the effect really is, but you can rule out any effect size bigger than your original d-value. In turn this helps future researchers plan their studies better and can guide them better in knowing how many participants to run. See how useful it would be if we published null findings!</p>
<p>Basically, when your test finds an effect size smaller than you can detect, you don’t know what it is but you know what it isn’t - we aren’t sure if it is a mouse but we know it is not an elephant. Instead you would use previous findings to support the object being a mouse or not but caveat the conclusion with the suggestion that the test isn’t really sensitive to finding a mouse. Similar to a finding that has an effect size smaller than you can detect. You can use previous literature to support their not being an effect but you can’t rule it out for sure. You might have actually found an effect had you had a more powerful test. Just like you might have been able to determine that it was a mouse had you had a more powerful telescope.</p>
<p>Taking this a bit further in some studies there really is enough power (in terms of N - say a study of 25000 participants) to find a flea on the proverbial mouse, but where nevertheless there is a non-significant finding. In this case you have the fortunate situation where you have a well-powered study and so can say with some degree of confidence that your hypothesis and design is unlikely to ever produce a replicable significant result. That is probably about as certain as you can get in our science or as close as you can get to a “fact”, a very rare and precious thing. However, incredibly high powered studies, with lots of participants, tend to be able to find any difference as a significant difference. A within-subjects design with 10000 participants (Power = .8, <span class="math inline">\(\alpha = .05\)</span>) can determine reliably detect an incredibly small effect size of d = 0.04. The question at that stage is whether that effect has any real world significance or meaning.</p>
<p>So the take-home message here is that your discussion should always consider the result in relation to the hypothesis, integrating previous research and theory, and if there is an additional issue of power, then your discussion could also consider the result in relation to whether you can truly determine the effect and how that might be resolved (e.g.&nbsp;re-assessing the effect size, changing the design (within is more powerful), low sample, power to high (e.g.&nbsp;.9), alpha to low (e.g.&nbsp;.01)). This issue of power would probably be a small part in the generalisability/limitation section.</p>
<p>And finally, n all of the above you can swap effect and relationship, d and r, and other analyses accordingly.</p>
<p>That is end of this chapter. Be sure to look again at anything you were unsure about and make some notes to help develop your own knowledge and skills. It would be good to write yourself some questions about what you are unsure of and see if you can answer them later or speak to someone about them. Good work today!</p>


</section></section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script>
// open rdrr links externally ----

var exlinks = document.querySelectorAll("a[href^='https://rdrr.io']");
var exlink_func = function(){
  window.open(this.href);
  return false;
};
for (var i = 0; i < exlinks.length; i++) {
    exlinks[i].addEventListener('click', exlink_func, false);
}

// visible second sidebar in mobile ----

function move_sidebar() {
  var toc = document.getElementById("TOC");
  var small_sidebar = document.querySelector("#quarto-sidebar .sidebar-menu-container");
  var right_sidebar = document.getElementById("quarto-margin-sidebar");

  if (window.innerWidth < 768) {
    small_sidebar.append(toc);
  } else {
    right_sidebar.append(toc);
  }
}
move_sidebar();
window.onresize = move_sidebar;
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./10-t-tests.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">t-tests</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./12-missing-data.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Screening Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">CC-BY (2024) James Bartlett &amp; Wil Toivo</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>